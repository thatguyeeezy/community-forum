exports.id=486,exports.ids=[486],exports.modules={96487:()=>{},78335:()=>{},97643:(e,r,d)=>{"use strict";d.d(r,{BT:()=>n,Wu:()=>l,ZB:()=>c,Zp:()=>a,aR:()=>i,wL:()=>u});var o=d(45512),t=d(58009),s=d(59462);let a=t.forwardRef(({className:e,...r},d)=>(0,o.jsx)("div",{ref:d,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...r}));a.displayName="Card";let i=t.forwardRef(({className:e,...r},d)=>(0,o.jsx)("div",{ref:d,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",e),...r}));i.displayName="CardHeader";let c=t.forwardRef(({className:e,...r},d)=>(0,o.jsx)("div",{ref:d,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",e),...r}));c.displayName="CardTitle";let n=t.forwardRef(({className:e,...r},d)=>(0,o.jsx)("div",{ref:d,className:(0,s.cn)("text-sm text-muted-foreground",e),...r}));n.displayName="CardDescription";let l=t.forwardRef(({className:e,...r},d)=>(0,o.jsx)("div",{ref:d,className:(0,s.cn)("p-6 pt-0",e),...r}));l.displayName="CardContent";let u=t.forwardRef(({className:e,...r},d)=>(0,o.jsx)("div",{ref:d,className:(0,s.cn)("flex items-center p-6 pt-0",e),...r}));u.displayName="CardFooter"},48859:(e,r,d)=>{"use strict";d.d(r,{T:()=>a});var o=d(45512),t=d(58009),s=d(59462);let a=t.forwardRef(({className:e,...r},d)=>(0,o.jsx)("textarea",{className:(0,s.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:d,...r}));a.displayName="Textarea"},94164:(e,r,d)=>{"use strict";d.d(r,{N:()=>c,p:()=>n});var o=d(21590);d(70376);var t=d(40492),s=d(47735),a=d(24118),i=d(94942);async function c(e){var r,d;let o=await (0,a.getServerSession)(i.N);if(!o?.user)return{error:"You must be logged in to create a thread"};let c=e.get("title"),n=e.get("content"),l=e.get("categoryId");if(!c||!n||!l)return{error:"Missing required fields"};if(r=o.user.role,d=o.user.department,"announcements"===l?"SENIOR_ADMIN"!==r&&"HEAD_ADMIN"!==r:"recruitment"===l?"RNR_ADMINISTRATION"!==d&&"RNR_STAFF"!==d:!r)return{error:"You don't have permission to create threads in this category"};try{let e=c.toLowerCase().replace(/[^\w\s]/gi,"").replace(/\s+/g,"-"),r=await t.z.thread.create({data:{title:c,slug:e,content:n,authorId:o.user.id,categoryId:l}});return(0,s.revalidatePath)(`/community/${l}`),(0,s.revalidatePath)("/community"),{success:!0,threadId:r.id}}catch(e){return console.error("Thread creation error:",e),{error:"Failed to create thread"}}}async function n(e){let r=await (0,a.getServerSession)(i.N);if(!r?.user)return{error:"You must be logged in to reply"};let d=e.get("content"),o=e.get("threadId");if(!d||!o)return{error:"Missing required fields"};try{let e=await t.z.thread.findUnique({where:{id:o},select:{categoryId:!0,locked:!0}});if(!e)return{error:"Thread not found"};if(e.locked&&!["ADMIN","MODERATOR","SENIOR_ADMIN","HEAD_ADMIN"].includes(r.user.role))return{error:"This thread is locked"};let a=await t.z.post.create({data:{content:d,authorId:r.user.id,threadId:o}});return await t.z.thread.update({where:{id:o},data:{updatedAt:new Date}}),(0,s.revalidatePath)(`/community/thread/${o}`),{success:!0,postId:a.id}}catch(e){return console.error("Post creation error:",e),{error:"Failed to create post"}}}(0,d(99344).D)([c,n]),(0,o.A)(c,"405c295700a4dfd6de233805d861f62411f68f5344",null),(0,o.A)(n,"4041daca40cd3939c4af74913a067b247306f56acc",null)},28933:(e,r,d)=>{"use strict";d.r(r),d.d(r,{default:()=>s,metadata:()=>t});var o=d(62740);let t={title:"Community - Florida Coast RP",description:"Browse discussions, resources, and departments in our community"};function s({children:e}){return(0,o.jsx)("div",{className:"flex min-h-screen flex-col",children:e})}},94942:(e,r,d)=>{"use strict";d.d(r,{N:()=>n,j:()=>l});var o=d(37067),t=d(10267),s=d(24118),a=d(24871),i=d(80225),c=d(40492);let n={adapter:(0,o.y)(c.z),pages:{signIn:"/auth/signin",signOut:"/auth/signout",error:"/auth/error"},session:{strategy:"jwt"},providers:[(0,i.A)({clientId:process.env.DISCORD_CLIENT_ID||"",clientSecret:process.env.DISCORD_CLIENT_SECRET||"",authorization:{params:{scope:"identify email"}},callbackUrl:"http://198.154.99.127:3000/auth/discord/callback",profile:e=>(console.log("Discord profile received:",e),{id:e.id,name:e.username,email:e.email,image:e.avatar?`https://cdn.discordapp.com/avatars/${e.id}/${e.avatar}.png`:null})}),(0,a.A)({name:"Credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)return null;let r=await c.z.user.findUnique({where:{email:e.email}});return r&&r.password&&await (0,t.UD)(e.password,r.password)?{id:r.id,email:r.email,name:r.name,image:r.image,role:r.role}:null}})],callbacks:{async signIn({user:e,account:r,profile:d}){if(r?.provider==="discord"&&d)try{console.log("Discord sign-in for user ID:",e.id),await c.z.user.update({where:{id:Number.parseInt(e.id,10)},data:{discordId:d.id,department:"N_A"}}),console.log("Updated user with Discord ID from profile:",d.id),setTimeout(async()=>{try{let r=await c.z.account.findFirst({where:{provider:"discord",userId:Number.parseInt(e.id,10)}});r&&(console.log("Found Discord account in accounts table:",r.providerAccountId),await c.z.user.update({where:{id:Number.parseInt(e.id,10)},data:{discordId:r.providerAccountId}}),console.log("Updated user with Discord ID from accounts table"))}catch(e){console.error("Error in delayed Discord ID update:",e)}},2e3)}catch(e){console.error("Error updating Discord ID during sign-in:",e)}return!0},async session({session:e,token:r}){if(e.user&&r.sub){e.user.id=r.sub,e.user.role=r.role,r.discordId&&(e.user.discordId=r.discordId);try{let d=Number.parseInt(r.sub,10),o=await c.z.user.findUnique({where:{id:d},select:{discordId:!0,department:!0,role:!0}});if(o&&(o.discordId&&(e.user.discordId=o.discordId),e.user.department=o.department,e.user.role=o.role,console.log("Session updated with user data:",{discordId:o.discordId,department:o.department,role:o.role}),!o.discordId)){let r=await c.z.account.findFirst({where:{provider:"discord",userId:d}});r&&(console.log("Found Discord account but user doesn't have Discord ID. Updating..."),await c.z.user.update({where:{id:d},data:{discordId:r.providerAccountId}}),e.user.discordId=r.providerAccountId,console.log("Updated user and session with Discord ID from accounts table"))}}catch(e){console.error("Error fetching user data for session:",e)}}return e},jwt:async({token:e,user:r,account:d,profile:o})=>(d&&r&&("discord"===d.provider&&o&&(e.discordId=o.id,console.log("Added Discord ID to JWT token:",o.id)),e.role=r.role),e)},events:{async createUser(e){let{user:r}=e;if(console.log("New user created:",r.id,r.email),r.email)try{setTimeout(async()=>{try{let e=await c.z.account.findFirst({where:{userId:r.id,provider:"discord"}});e&&(console.log("Found Discord account for new user:",e.providerAccountId),await c.z.user.update({where:{id:r.id},data:{discordId:e.providerAccountId,department:"N_A",role:"APPLICANT"}}),console.log("Updated new user with Discord ID and set as APPLICANT"))}catch(e){console.error("Error in delayed createUser processing:",e)}},2e3)}catch(e){console.error("Error in createUser event:",e)}},async linkAccount({user:e,account:r,profile:d}){if("discord"===r.provider&&d){console.log("Account linked:",e.id,r.provider,r.providerAccountId);try{await c.z.user.update({where:{id:e.id},data:{discordId:r.providerAccountId}}),console.log("Updated user with Discord ID from linkAccount event")}catch(e){console.error("Error updating Discord ID in linkAccount event:",e)}}}}};async function l(){return await (0,s.getServerSession)(n)}},45369:(e,r,d)=>{"use strict";d.d(r,{N:()=>n,j:()=>l});var o=d(46814),t=d(34926),s=d(51825),a=d(91642),i=d(64912),c=d(11587);let n={adapter:(0,o.y)(c.z),pages:{signIn:"/auth/signin",signOut:"/auth/signout",error:"/auth/error"},session:{strategy:"jwt"},providers:[(0,i.A)({clientId:process.env.DISCORD_CLIENT_ID||"",clientSecret:process.env.DISCORD_CLIENT_SECRET||"",authorization:{params:{scope:"identify email"}},callbackUrl:"http://198.154.99.127:3000/auth/discord/callback",profile:e=>(console.log("Discord profile received:",e),{id:e.id,name:e.username,email:e.email,image:e.avatar?`https://cdn.discordapp.com/avatars/${e.id}/${e.avatar}.png`:null})}),(0,a.A)({name:"Credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)return null;let r=await c.z.user.findUnique({where:{email:e.email}});return r&&r.password&&await (0,t.UD)(e.password,r.password)?{id:r.id,email:r.email,name:r.name,image:r.image,role:r.role}:null}})],callbacks:{async signIn({user:e,account:r,profile:d}){if(r?.provider==="discord"&&d)try{console.log("Discord sign-in for user ID:",e.id),await c.z.user.update({where:{id:Number.parseInt(e.id,10)},data:{discordId:d.id,department:"N_A"}}),console.log("Updated user with Discord ID from profile:",d.id),setTimeout(async()=>{try{let r=await c.z.account.findFirst({where:{provider:"discord",userId:Number.parseInt(e.id,10)}});r&&(console.log("Found Discord account in accounts table:",r.providerAccountId),await c.z.user.update({where:{id:Number.parseInt(e.id,10)},data:{discordId:r.providerAccountId}}),console.log("Updated user with Discord ID from accounts table"))}catch(e){console.error("Error in delayed Discord ID update:",e)}},2e3)}catch(e){console.error("Error updating Discord ID during sign-in:",e)}return!0},async session({session:e,token:r}){if(e.user&&r.sub){e.user.id=r.sub,e.user.role=r.role,r.discordId&&(e.user.discordId=r.discordId);try{let d=Number.parseInt(r.sub,10),o=await c.z.user.findUnique({where:{id:d},select:{discordId:!0,department:!0,role:!0}});if(o&&(o.discordId&&(e.user.discordId=o.discordId),e.user.department=o.department,e.user.role=o.role,console.log("Session updated with user data:",{discordId:o.discordId,department:o.department,role:o.role}),!o.discordId)){let r=await c.z.account.findFirst({where:{provider:"discord",userId:d}});r&&(console.log("Found Discord account but user doesn't have Discord ID. Updating..."),await c.z.user.update({where:{id:d},data:{discordId:r.providerAccountId}}),e.user.discordId=r.providerAccountId,console.log("Updated user and session with Discord ID from accounts table"))}}catch(e){console.error("Error fetching user data for session:",e)}}return e},jwt:async({token:e,user:r,account:d,profile:o})=>(d&&r&&("discord"===d.provider&&o&&(e.discordId=o.id,console.log("Added Discord ID to JWT token:",o.id)),e.role=r.role),e)},events:{async createUser(e){let{user:r}=e;if(console.log("New user created:",r.id,r.email),r.email)try{setTimeout(async()=>{try{let e=await c.z.account.findFirst({where:{userId:r.id,provider:"discord"}});e&&(console.log("Found Discord account for new user:",e.providerAccountId),await c.z.user.update({where:{id:r.id},data:{discordId:e.providerAccountId,department:"N_A",role:"APPLICANT"}}),console.log("Updated new user with Discord ID and set as APPLICANT"))}catch(e){console.error("Error in delayed createUser processing:",e)}},2e3)}catch(e){console.error("Error in createUser event:",e)}},async linkAccount({user:e,account:r,profile:d}){if("discord"===r.provider&&d){console.log("Account linked:",e.id,r.provider,r.providerAccountId);try{await c.z.user.update({where:{id:e.id},data:{discordId:r.providerAccountId}}),console.log("Updated user with Discord ID from linkAccount event")}catch(e){console.error("Error updating Discord ID in linkAccount event:",e)}}}}};async function l(){return await (0,s.getServerSession)(n)}},40492:(e,r,d)=>{"use strict";d.d(r,{z:()=>t});var o=d(96330);let t=globalThis.prisma??new o.PrismaClient},11587:(e,r,d)=>{"use strict";d.d(r,{z:()=>t});var o=d(96330);let t=globalThis.prisma??new o.PrismaClient}};