/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/auth/[...nextauth]/route";
exports.ids = ["app/api/auth/[...nextauth]/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

"use strict";
module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("assert");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ "querystring":
/*!******************************!*\
  !*** external "querystring" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("querystring");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ }),

/***/ "@prisma/client/runtime/library":
/*!*************************************************!*\
  !*** external "@prisma/client/runtime/library" ***!
  \*************************************************/
/***/ ((module) => {

"use strict";
module.exports = import("@prisma/client/runtime/library");;

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&page=%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute.ts&appDir=C%3A%5Cxampp%5Cnodejs-apps%5Ccommunity-forum%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5Cxampp%5Cnodejs-apps%5Ccommunity-forum&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&page=%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute.ts&appDir=C%3A%5Cxampp%5Cnodejs-apps%5Ccommunity-forum%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5Cxampp%5Cnodejs-apps%5Ccommunity-forum&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_xampp_nodejs_apps_community_forum_app_api_auth_nextauth_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/auth/[...nextauth]/route.ts */ \"(rsc)/./app/api/auth/[...nextauth]/route.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([C_xampp_nodejs_apps_community_forum_app_api_auth_nextauth_route_ts__WEBPACK_IMPORTED_MODULE_3__]);\nC_xampp_nodejs_apps_community_forum_app_api_auth_nextauth_route_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/auth/[...nextauth]/route\",\n        pathname: \"/api/auth/[...nextauth]\",\n        filename: \"route\",\n        bundlePath: \"app/api/auth/[...nextauth]/route\"\n    },\n    resolvedPagePath: \"C:\\\\xampp\\\\nodejs-apps\\\\community-forum\\\\app\\\\api\\\\auth\\\\[...nextauth]\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_xampp_nodejs_apps_community_forum_app_api_auth_nextauth_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIvaW5kZXguanM/bmFtZT1hcHAlMkZhcGklMkZhdXRoJTJGJTVCLi4ubmV4dGF1dGglNUQlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmF1dGglMkYlNUIuLi5uZXh0YXV0aCU1RCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmF1dGglMkYlNUIuLi5uZXh0YXV0aCU1RCUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDeGFtcHAlNUNub2RlanMtYXBwcyU1Q2NvbW11bml0eS1mb3J1bSU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q3hhbXBwJTVDbm9kZWpzLWFwcHMlNUNjb21tdW5pdHktZm9ydW0maXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQStGO0FBQ3ZDO0FBQ3FCO0FBQ2dDO0FBQzdHO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix5R0FBbUI7QUFDM0M7QUFDQSxjQUFjLGtFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsc0RBQXNEO0FBQzlEO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzBGOztBQUUxRixxQyIsInNvdXJjZXMiOlsiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJDOlxcXFx4YW1wcFxcXFxub2RlanMtYXBwc1xcXFxjb21tdW5pdHktZm9ydW1cXFxcYXBwXFxcXGFwaVxcXFxhdXRoXFxcXFsuLi5uZXh0YXV0aF1cXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2F1dGgvWy4uLm5leHRhdXRoXS9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2F1dGgvWy4uLm5leHRhdXRoXVwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvYXV0aC9bLi4ubmV4dGF1dGhdL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiQzpcXFxceGFtcHBcXFxcbm9kZWpzLWFwcHNcXFxcY29tbXVuaXR5LWZvcnVtXFxcXGFwcFxcXFxhcGlcXFxcYXV0aFxcXFxbLi4ubmV4dGF1dGhdXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgd29ya0FzeW5jU3RvcmFnZSwgd29ya1VuaXRBc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgd29ya0FzeW5jU3RvcmFnZSxcbiAgICAgICAgd29ya1VuaXRBc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCB3b3JrQXN5bmNTdG9yYWdlLCB3b3JrVW5pdEFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&page=%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute.ts&appDir=C%3A%5Cxampp%5Cnodejs-apps%5Ccommunity-forum%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5Cxampp%5Cnodejs-apps%5Ccommunity-forum&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./app/api/auth/[...nextauth]/route.ts":
/*!*********************************************!*\
  !*** ./app/api/auth/[...nextauth]/route.ts ***!
  \*********************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ handler),\n/* harmony export */   POST: () => (/* binding */ handler),\n/* harmony export */   authOptions: () => (/* binding */ authOptions)\n/* harmony export */ });\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth */ \"(rsc)/./node_modules/next-auth/index.js\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_auth__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_auth_providers_discord__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth/providers/discord */ \"(rsc)/./node_modules/next-auth/providers/discord.js\");\n/* harmony import */ var next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next-auth/providers/credentials */ \"(rsc)/./node_modules/next-auth/providers/credentials.js\");\n/* harmony import */ var _auth_prisma_adapter__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @auth/prisma-adapter */ \"(rsc)/./node_modules/@auth/prisma-adapter/index.js\");\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./lib/prisma.ts\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var _lib_main_discord__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/lib/main-discord */ \"(rsc)/./lib/main-discord.ts\");\n/* harmony import */ var _lib_roles__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @/lib/roles */ \"(rsc)/./lib/roles.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_auth_prisma_adapter__WEBPACK_IMPORTED_MODULE_3__]);\n_auth_prisma_adapter__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\n\n\n// Import the role helper functions at the top of the file\n\n// Export the authOptions for use in other files\nconst authOptions = {\n    adapter: (0,_auth_prisma_adapter__WEBPACK_IMPORTED_MODULE_3__.PrismaAdapter)(_lib_prisma__WEBPACK_IMPORTED_MODULE_4__.prisma),\n    providers: [\n        (0,next_auth_providers_discord__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n            clientId: process.env.DISCORD_CLIENT_ID || \"\",\n            clientSecret: process.env.DISCORD_CLIENT_SECRET || \"\",\n            authorization: {\n                params: {\n                    scope: \"identify email\"\n                }\n            },\n            profile (profile) {\n                if (profile.id) {\n                    return {\n                        id: profile.id,\n                        name: profile.global_name || profile.username,\n                        email: profile.email,\n                        image: profile.avatar ? `https://cdn.discordapp.com/avatars/${profile.id}/${profile.avatar}.png` : null,\n                        role: \"APPLICANT\"\n                    };\n                }\n                return {\n                    id: profile.user?.id || profile.sub || \"discord-user\",\n                    name: profile.global_name || profile.username || profile.user?.username,\n                    email: profile.email || profile.user?.email,\n                    image: profile.avatar ? `https://cdn.discordapp.com/avatars/${profile.id || profile.user?.id}/${profile.avatar || profile.user?.avatar}.png` : null,\n                    role: \"APPLICANT\"\n                };\n            }\n        }),\n        (0,next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_2__[\"default\"])({\n            name: \"Admin Credentials\",\n            credentials: {\n                email: {\n                    label: \"Email\",\n                    type: \"email\"\n                },\n                password: {\n                    label: \"Password\",\n                    type: \"password\"\n                }\n            },\n            async authorize (credentials) {\n                if (!credentials?.email || !credentials?.password) {\n                    return null;\n                }\n                const user = await _lib_prisma__WEBPACK_IMPORTED_MODULE_4__.prisma.user.findUnique({\n                    where: {\n                        email: credentials.email\n                    }\n                });\n                if (!user || !user.password) {\n                    return null;\n                }\n                const isPasswordValid = await (0,bcryptjs__WEBPACK_IMPORTED_MODULE_5__.compare)(credentials.password, user.password);\n                if (!isPasswordValid) {\n                    return null;\n                }\n                return {\n                    id: user.id.toString(),\n                    email: user.email,\n                    name: user.name,\n                    image: user.image,\n                    role: user.role\n                };\n            }\n        })\n    ],\n    callbacks: {\n        async session ({ session, token }) {\n            if (session?.user) {\n                session.user.id = Number.parseInt(token.sub || \"0\") // Parse the ID as an integer\n                ;\n                session.user.role = token.role || \"MEMBER\";\n                // Pass through the onboarding flags\n                if (token.needsOnboarding !== undefined) {\n                    session.user.needsOnboarding = token.needsOnboarding;\n                }\n                if (token.isInMainDiscord) {\n                    session.user.isInMainDiscord = token.isInMainDiscord;\n                }\n                if (token.mainDiscordDepartments) {\n                    session.user.mainDiscordDepartments = token.mainDiscordDepartments;\n                }\n            }\n            return session;\n        },\n        async jwt ({ token, user, account, profile, trigger }) {\n            // If this is a sign-in or token update\n            if (user) {\n                token.role = user.role || \"MEMBER\";\n            }\n            // Check for session update trigger\n            if (trigger === \"update\") {\n                // Fetch the latest user data from the database to update the token\n                const dbUser = await _lib_prisma__WEBPACK_IMPORTED_MODULE_4__.prisma.user.findUnique({\n                    where: {\n                        id: Number(token.sub)\n                    },\n                    select: {\n                        needsOnboarding: true,\n                        role: true\n                    }\n                });\n                if (dbUser) {\n                    token.needsOnboarding = dbUser.needsOnboarding;\n                    token.role = dbUser.role;\n                    console.log(`JWT updated via trigger: needsOnboarding=${dbUser.needsOnboarding}, role=${dbUser.role}`);\n                }\n                return token;\n            }\n            // If this is a new sign-in with Discord\n            if (account?.provider === \"discord\" && profile) {\n                console.log(`New Discord sign-in for user ID: ${token.sub}`);\n                // Check if user exists in database with Discord ID\n                const existingUser = await _lib_prisma__WEBPACK_IMPORTED_MODULE_4__.prisma.user.findFirst({\n                    where: {\n                        discordId: profile.id\n                    }\n                });\n                // Get the user by sub ID (this is the user that was just created by the adapter)\n                const newUser = await _lib_prisma__WEBPACK_IMPORTED_MODULE_4__.prisma.user.findUnique({\n                    where: {\n                        id: Number(token.sub)\n                    }\n                });\n                // If this is a completely new user (no existing Discord ID)\n                if (!existingUser) {\n                    console.log(`No existing user with Discord ID: ${profile.id}`);\n                    // Check if user is in Main Discord\n                    const isInMainDiscord = await (0,_lib_main_discord__WEBPACK_IMPORTED_MODULE_6__.isUserInMainDiscord)(profile.id);\n                    console.log(`User in Main Discord: ${isInMainDiscord}`);\n                    if (isInMainDiscord) {\n                        // For Main Discord members, set needsOnboarding to true\n                        token.needsOnboarding = true;\n                        token.isInMainDiscord = true;\n                        // Get departments from Main Discord\n                        const departments = await (0,_lib_main_discord__WEBPACK_IMPORTED_MODULE_6__.getUserDepartmentsFromMainDiscord)(profile.id);\n                        if (departments.length > 0) {\n                            token.mainDiscordDepartments = departments;\n                        }\n                        // Update the user with needsOnboarding flag and Discord ID\n                        await _lib_prisma__WEBPACK_IMPORTED_MODULE_4__.prisma.user.update({\n                            where: {\n                                id: Number(token.sub)\n                            },\n                            data: {\n                                needsOnboarding: true,\n                                discordId: profile.id\n                            }\n                        });\n                        console.log(`Updated user ${token.sub} with needsOnboarding=true and discordId=${profile.id}`);\n                    } else {\n                        // For Fan Discord members, just create as APPLICANT with no onboarding\n                        token.needsOnboarding = false;\n                        token.isInMainDiscord = false;\n                        // Update the user with Discord ID\n                        await _lib_prisma__WEBPACK_IMPORTED_MODULE_4__.prisma.user.update({\n                            where: {\n                                id: Number(token.sub)\n                            },\n                            data: {\n                                needsOnboarding: false,\n                                discordId: profile.id,\n                                role: \"APPLICANT\"\n                            }\n                        });\n                        console.log(`Updated user ${token.sub} with needsOnboarding=false, role=APPLICANT, and discordId=${profile.id}`);\n                    }\n                } else {\n                    // Existing user - get their needsOnboarding status\n                    console.log(`Found existing user with Discord ID: ${profile.id}`);\n                    const dbUser = await _lib_prisma__WEBPACK_IMPORTED_MODULE_4__.prisma.user.findUnique({\n                        where: {\n                            id: Number(token.sub)\n                        },\n                        select: {\n                            needsOnboarding: true,\n                            role: true\n                        }\n                    });\n                    if (dbUser) {\n                        token.needsOnboarding = dbUser.needsOnboarding;\n                        token.role = dbUser.role;\n                        console.log(`Set token from existing user: needsOnboarding=${dbUser.needsOnboarding}, role=${dbUser.role}`);\n                    }\n                }\n            }\n            return token;\n        },\n        async signIn ({ user, account, profile }) {\n            // Always allow Discord sign-ins\n            if (account?.provider === \"discord\") {\n                return true;\n            }\n            // For credentials (admin), check if the user has admin role\n            if (account?.provider === \"credentials\") {\n                const dbUser = await _lib_prisma__WEBPACK_IMPORTED_MODULE_4__.prisma.user.findUnique({\n                    where: {\n                        id: Number.parseInt(user.id)\n                    },\n                    select: {\n                        role: true\n                    }\n                });\n                // Use our helper functions to check permissions\n                return dbUser?.role ? (0,_lib_roles__WEBPACK_IMPORTED_MODULE_7__.hasAdminPermission)(dbUser.role) || (0,_lib_roles__WEBPACK_IMPORTED_MODULE_7__.hasStaffPermission)(dbUser.role) : false;\n            }\n            return false;\n        }\n    },\n    pages: {\n        signIn: \"/auth/signin\",\n        signOut: \"/auth/signout\",\n        error: \"/auth/error\"\n    },\n    session: {\n        strategy: \"jwt\"\n    },\n    debug: \"development\" === \"development\"\n};\nconst handler = next_auth__WEBPACK_IMPORTED_MODULE_0___default()(authOptions);\n\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2F1dGgvWy4uLm5leHRhdXRoXS9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBZ0M7QUFDeUI7QUFDUTtBQUNiO0FBQ2Y7QUFDSDtBQUV5RDtBQUUzRiwwREFBMEQ7QUFDVTtBQUVwRSxnREFBZ0Q7QUFDekMsTUFBTVUsY0FBK0I7SUFDMUNDLFNBQVNSLG1FQUFhQSxDQUFDQywrQ0FBTUE7SUFDN0JRLFdBQVc7UUFDVFgsdUVBQWVBLENBQUM7WUFDZFksVUFBVUMsUUFBUUMsR0FBRyxDQUFDQyxpQkFBaUIsSUFBSTtZQUMzQ0MsY0FBY0gsUUFBUUMsR0FBRyxDQUFDRyxxQkFBcUIsSUFBSTtZQUNuREMsZUFBZTtnQkFBRUMsUUFBUTtvQkFBRUMsT0FBTztnQkFBaUI7WUFBRTtZQUNyREMsU0FBUUEsT0FBTztnQkFDYixJQUFJQSxRQUFRQyxFQUFFLEVBQUU7b0JBQ2QsT0FBTzt3QkFDTEEsSUFBSUQsUUFBUUMsRUFBRTt3QkFDZEMsTUFBTUYsUUFBUUcsV0FBVyxJQUFJSCxRQUFRSSxRQUFRO3dCQUM3Q0MsT0FBT0wsUUFBUUssS0FBSzt3QkFDcEJDLE9BQU9OLFFBQVFPLE1BQU0sR0FBRyxDQUFDLG1DQUFtQyxFQUFFUCxRQUFRQyxFQUFFLENBQUMsQ0FBQyxFQUFFRCxRQUFRTyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUc7d0JBQ25HQyxNQUFNO29CQUNSO2dCQUNGO2dCQUVBLE9BQU87b0JBQ0xQLElBQUlELFFBQVFTLElBQUksRUFBRVIsTUFBTUQsUUFBUVUsR0FBRyxJQUFJO29CQUN2Q1IsTUFBTUYsUUFBUUcsV0FBVyxJQUFJSCxRQUFRSSxRQUFRLElBQUlKLFFBQVFTLElBQUksRUFBRUw7b0JBQy9EQyxPQUFPTCxRQUFRSyxLQUFLLElBQUlMLFFBQVFTLElBQUksRUFBRUo7b0JBQ3RDQyxPQUFPTixRQUFRTyxNQUFNLEdBQ2pCLENBQUMsbUNBQW1DLEVBQUVQLFFBQVFDLEVBQUUsSUFBSUQsUUFB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OUNILE1BQU1kLElBQUksR0FBR3dCLE9BQU94QixJQUFJO3dCQUN4QjBCLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLDhDQUE4QyxFQUFFSCxPQUFPUCxlQUFlLENBQUMsT0FBTyxFQUFFTyxPQUFPeEIsSUFBSSxFQUFFO29CQUM1RztnQkFDRjtZQUNGO1lBRUEsT0FBT2M7UUFDVDtRQUNBLE1BQU11QixRQUFPLEVBQUVwQyxJQUFJLEVBQUVxQixPQUFPLEVBQUU5QixPQUFPLEVBQUU7WUFDckMsZ0NBQWdDO1lBQ2hDLElBQUk4QixTQUFTTSxhQUFhLFdBQVc7Z0JBQ25DLE9BQU87WUFDVDtZQUVBLDREQUE0RDtZQUM1RCxJQUFJTixTQUFTTSxhQUFhLGVBQWU7Z0JBQ3ZDLE1BQU1KLFNBQVMsTUFBTWxELCtDQUFNQSxDQUFDMkIsSUFBSSxDQUFDTyxVQUFVLENBQUM7b0JBQzFDQyxPQUFPO3dCQUFFaEIsSUFBSXNCLE9BQU9DLFFBQVEsQ0FBQ2YsS0FBS1IsRUFBRTtvQkFBRTtvQkFDdENnQyxRQUFRO3dCQUFFekIsTUFBTTtvQkFBSztnQkFDdkI7Z0JBRUEsZ0RBQWdEO2dCQUNoRCxPQUFPd0IsUUFBUXhCLE9BQU90Qiw4REFBa0JBLENBQUM4QyxPQUFPeEIsSUFBSSxLQUFLckIsOERBQWtCQSxDQUFDNkMsT0FBT3hCLElBQUksSUFBSTtZQUM3RjtZQUVBLE9BQU87UUFDVDtJQUNGO0lBQ0FzQyxPQUFPO1FBQ0xELFFBQVE7UUFDUkUsU0FBUztRQUNUQyxPQUFPO0lBQ1Q7SUFDQTNCLFNBQVM7UUFDUDRCLFVBQVU7SUFDWjtJQUNBQyxPQUFPMUQsa0JBQXlCO0FBQ2xDLEVBQUM7QUFFRCxNQUFNMkQsVUFBVXpFLGdEQUFRQSxDQUFDVTtBQUVpQiIsInNvdXJjZXMiOlsiQzpcXHhhbXBwXFxub2RlanMtYXBwc1xcY29tbXVuaXR5LWZvcnVtXFxhcHBcXGFwaVxcYXV0aFxcWy4uLm5leHRhdXRoXVxccm91dGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IE5leHRBdXRoIGZyb20gXCJuZXh0LWF1dGhcIlxyXG5pbXBvcnQgRGlzY29yZFByb3ZpZGVyIGZyb20gXCJuZXh0LWF1dGgvcHJvdmlkZXJzL2Rpc2NvcmRcIlxyXG5pbXBvcnQgQ3JlZGVudGlhbHNQcm92aWRlciBmcm9tIFwibmV4dC1hdXRoL3Byb3ZpZGVycy9jcmVkZW50aWFsc1wiXHJcbmltcG9ydCB7IFByaXNtYUFkYXB0ZXIgfSBmcm9tIFwiQGF1dGgvcHJpc21hLWFkYXB0ZXJcIlxyXG5pbXBvcnQgeyBwcmlzbWEgfSBmcm9tIFwiQC9saWIvcHJpc21hXCJcclxuaW1wb3J0IHsgY29tcGFyZSB9IGZyb20gXCJiY3J5cHRqc1wiXHJcbmltcG9ydCB0eXBlIHsgTmV4dEF1dGhPcHRpb25zIH0gZnJvbSBcIm5leHQtYXV0aFwiXHJcbmltcG9ydCB7IGlzVXNlckluTWFpbkRpc2NvcmQsIGdldFVzZXJEZXBhcnRtZW50c0Zyb21NYWluRGlzY29yZCB9IGZyb20gXCJAL2xpYi9tYWluLWRpc2NvcmRcIlxyXG5cclxuLy8gSW1wb3J0IHRoZSByb2xlIGhlbHBlciBmdW5jdGlvbnMgYXQgdGhlIHRvcCBvZiB0aGUgZmlsZVxyXG5pbXBvcnQgeyBoYXNBZG1pblBlcm1pc3Npb24sIGhhc1N0YWZmUGVybWlzc2lvbiB9IGZyb20gXCJAL2xpYi9yb2xlc1wiXHJcblxyXG4vLyBFeHBvcnQgdGhlIGF1dGhPcHRpb25zIGZvciB1c2UgaW4gb3RoZXIgZmlsZXNcclxuZXhwb3J0IGNvbnN0IGF1dGhPcHRpb25zOiBOZXh0QXV0aE9wdGlvbnMgPSB7XHJcbiAgYWRhcHRlcjogUHJpc21hQWRhcHRlcihwcmlzbWEpLFxyXG4gIHByb3ZpZGVyczogW1xyXG4gICAgRGlzY29yZFByb3ZpZGVyKHtcclxuICAgICAgY2xpZW50SWQ6IHByb2Nlc3MuZW52LkRJU0NPUkRfQ0xJRU5UX0lEIHx8IFwiXCIsXHJcbiAgICAgIGNsaWVudFNlY3JldDogcHJvY2Vzcy5lbnYuRElTQ09SRF9DTElFTlRfU0VDUkVUIHx8IFwiXCIsXHJcbiAgICAgIGF1dGhvcml6YXRpb246IHsgcGFyYW1zOiB7IHNjb3BlOiBcImlkZW50aWZ5IGVtYWlsXCIgfSB9LFxyXG4gICAgICBwcm9maWxlKHByb2ZpbGUpIHtcclxuICAgICAgICBpZiAocHJvZmlsZS5pZCkge1xyXG4gICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgaWQ6IHByb2ZpbGUuaWQsXHJcbiAgICAgICAgICAgIG5hbWU6IHByb2ZpbGUuZ2xvYmFsX25hbWUgfHwgcHJvZmlsZS51c2VybmFtZSxcclxuICAgICAgICAgICAgZW1haWw6IHByb2ZpbGUuZW1haWwsXHJcbiAgICAgICAgICAgIGltYWdlOiBwcm9maWxlLmF2YXRhciA/IGBodHRwczovL2Nkbi5kaXNjb3JkYXBwLmNvbS9hdmF0YXJzLyR7cHJvZmlsZS5pZH0vJHtwcm9maWxlLmF2YXRhcn0ucG5nYCA6IG51bGwsXHJcbiAgICAgICAgICAgIHJvbGU6IFwiQVBQTElDQU5UXCIsXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgaWQ6IHByb2ZpbGUudXNlcj8uaWQgfHwgcHJvZmlsZS5zdWIgfHwgXCJkaXNjb3JkLXVzZXJcIixcclxuICAgICAgICAgIG5hbWU6IHByb2ZpbGUuZ2xvYmFsX25hbWUgfHwgcHJvZmlsZS51c2VybmFtZSB8fCBwcm9maWxlLnVzZXI/LnVzZXJuYW1lLFxyXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUuZW1haWwgfHwgcHJvZmlsZS51c2VyPy5lbWFpbCxcclxuICAgICAgICAgIGltYWdlOiBwcm9maWxlLmF2YXRhclxyXG4gICAgICAgICAgICA/IGBodHRwczovL2Nkbi5kaXNjb3JkYXBwLmNvbS9hdmF0YXJzLyR7cHJvZmlsZS5pZCB8fCBwcm9maWxlLnVzZXI/LmlkfS8ke3Byb2ZpbGUuYXZhdGFyIHx8IHByb2ZpbGUudXNlcj8uYXZhdGFyfS5wbmdgXHJcbiAgICAgICAgICAgIDogbnVsbCxcclxuICAgICAgICAgIHJvbGU6IFwiQVBQTElDQU5UXCIsXHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgfSksXHJcbiAgICBDcmVkZW50aWFsc1Byb3ZpZGVyKHtcclxuICAgICAgbmFtZTogXCJBZG1pbiBDcmVkZW50aWFsc1wiLFxyXG4gICAgICBjcmVkZW50aWFsczoge1xyXG4gICAgICAgIGVtYWlsOiB7IGxhYmVsOiBcIkVtYWlsXCIsIHR5cGU6IFwiZW1haWxcIiB9LFxyXG4gICAgICAgIHBhc3N3b3JkOiB7IGxhYmVsOiBcIlBhc3N3b3JkXCIsIHR5cGU6IFwicGFzc3dvcmRcIiB9LFxyXG4gICAgICB9LFxyXG4gICAgICBhc3luYyBhdXRob3JpemUoY3JlZGVudGlhbHMpIHtcclxuICAgICAgICBpZiAoIWNyZWRlbnRpYWxzPy5lbWFpbCB8fCAhY3JlZGVudGlhbHM/LnBhc3N3b3JkKSB7XHJcbiAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgd2hlcmU6IHtcclxuICAgICAgICAgICAgZW1haWw6IGNyZWRlbnRpYWxzLmVtYWlsLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICBpZiAoIXVzZXIgfHwgIXVzZXIucGFzc3dvcmQpIHtcclxuICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBpc1Bhc3N3b3JkVmFsaWQgPSBhd2FpdCBjb21wYXJlKGNyZWRlbnRpYWxzLnBhc3N3b3JkLCB1c2VyLnBhc3N3b3JkKVxyXG5cclxuICAgICAgICBpZiAoIWlzUGFzc3dvcmRWYWxpZCkge1xyXG4gICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBpZDogdXNlci5pZC50b1N0cmluZygpLCAvLyBDb252ZXJ0IHRvIHN0cmluZyBmb3IgTmV4dEF1dGhcclxuICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxyXG4gICAgICAgICAgbmFtZTogdXNlci5uYW1lLFxyXG4gICAgICAgICAgaW1hZ2U6IHVzZXIuaW1hZ2UsXHJcbiAgICAgICAgICByb2xlOiB1c2VyLnJvbGUsXHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgfSksXHJcbiAgXSxcclxuICBjYWxsYmFja3M6IHtcclxuICAgIGFzeW5jIHNlc3Npb24oeyBzZXNzaW9uLCB0b2tlbiB9KSB7XHJcbiAgICAgIGlmIChzZXNzaW9uPy51c2VyKSB7XHJcbiAgICAgICAgc2Vzc2lvbi51c2VyLmlkID0gTnVtYmVyLnBhcnNlSW50KHRva2VuLnN1YiB8fCBcIjBcIikgLy8gUGFyc2UgdGhlIElEIGFzIGFuIGludGVnZXJcclxuICAgICAgICBzZXNzaW9uLnVzZXIucm9sZSA9IHRva2VuLnJvbGUgfHwgXCJNRU1CRVJcIlxyXG5cclxuICAgICAgICAvLyBQYXNzIHRocm91Z2ggdGhlIG9uYm9hcmRpbmcgZmxhZ3NcclxuICAgICAgICBpZiAodG9rZW4ubmVlZHNPbmJvYXJkaW5nICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgIHNlc3Npb24udXNlci5uZWVkc09uYm9hcmRpbmcgPSB0b2tlbi5uZWVkc09uYm9hcmRpbmcgYXMgYm9vbGVhblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRva2VuLmlzSW5NYWluRGlzY29yZCkge1xyXG4gICAgICAgICAgc2Vzc2lvbi51c2VyLmlzSW5NYWluRGlzY29yZCA9IHRva2VuLmlzSW5NYWluRGlzY29yZCBhcyBib29sZWFuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodG9rZW4ubWFpbkRpc2NvcmREZXBhcnRtZW50cykge1xyXG4gICAgICAgICAgc2Vzc2lvbi51c2VyLm1haW5EaXNjb3JkRGVwYXJ0bWVudHMgPSB0b2tlbi5tYWluRGlzY29yZERlcGFydG1lbnRzIGFzIHN0cmluZ1tdXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBzZXNzaW9uXHJcbiAgICB9LFxyXG4gICAgYXN5bmMgand0KHsgdG9rZW4sIHVzZXIsIGFjY291bnQsIHByb2ZpbGUsIHRyaWdnZXIgfSkge1xyXG4gICAgICAvLyBJZiB0aGlzIGlzIGEgc2lnbi1pbiBvciB0b2tlbiB1cGRhdGVcclxuICAgICAgaWYgKHVzZXIpIHtcclxuICAgICAgICB0b2tlbi5yb2xlID0gdXNlci5yb2xlIHx8IFwiTUVNQkVSXCJcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gQ2hlY2sgZm9yIHNlc3Npb24gdXBkYXRlIHRyaWdnZXJcclxuICAgICAgaWYgKHRyaWdnZXIgPT09IFwidXBkYXRlXCIpIHtcclxuICAgICAgICAvLyBGZXRjaCB0aGUgbGF0ZXN0IHVzZXIgZGF0YSBmcm9tIHRoZSBkYXRhYmFzZSB0byB1cGRhdGUgdGhlIHRva2VuXHJcbiAgICAgICAgY29uc3QgZGJVc2VyID0gYXdhaXQgcHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICB3aGVyZTogeyBpZDogTnVtYmVyKHRva2VuLnN1YikgfSxcclxuICAgICAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgICAgICBuZWVkc09uYm9hcmRpbmc6IHRydWUsXHJcbiAgICAgICAgICAgIHJvbGU6IHRydWUsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIGlmIChkYlVzZXIpIHtcclxuICAgICAgICAgIHRva2VuLm5lZWRzT25ib2FyZGluZyA9IGRiVXNlci5uZWVkc09uYm9hcmRpbmdcclxuICAgICAgICAgIHRva2VuLnJvbGUgPSBkYlVzZXIucm9sZVxyXG4gICAgICAgICAgY29uc29sZS5sb2coYEpXVCB1cGRhdGVkIHZpYSB0cmlnZ2VyOiBuZWVkc09uYm9hcmRpbmc9JHtkYlVzZXIubmVlZHNPbmJvYXJkaW5nfSwgcm9sZT0ke2RiVXNlci5yb2xlfWApXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdG9rZW5cclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gSWYgdGhpcyBpcyBhIG5ldyBzaWduLWluIHdpdGggRGlzY29yZFxyXG4gICAgICBpZiAoYWNjb3VudD8ucHJvdmlkZXIgPT09IFwiZGlzY29yZFwiICYmIHByb2ZpbGUpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhgTmV3IERpc2NvcmQgc2lnbi1pbiBmb3IgdXNlciBJRDogJHt0b2tlbi5zdWJ9YClcclxuXHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgdXNlciBleGlzdHMgaW4gZGF0YWJhc2Ugd2l0aCBEaXNjb3JkIElEXHJcbiAgICAgICAgY29uc3QgZXhpc3RpbmdVc2VyID0gYXdhaXQgcHJpc21hLnVzZXIuZmluZEZpcnN0KHtcclxuICAgICAgICAgIHdoZXJlOiB7IGRpc2NvcmRJZDogcHJvZmlsZS5pZCBhcyBzdHJpbmcgfSxcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICAvLyBHZXQgdGhlIHVzZXIgYnkgc3ViIElEICh0aGlzIGlzIHRoZSB1c2VyIHRoYXQgd2FzIGp1c3QgY3JlYXRlZCBieSB0aGUgYWRhcHRlcilcclxuICAgICAgICBjb25zdCBuZXdVc2VyID0gYXdhaXQgcHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICB3aGVyZTogeyBpZDogTnVtYmVyKHRva2VuLnN1YikgfSxcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICAvLyBJZiB0aGlzIGlzIGEgY29tcGxldGVseSBuZXcgdXNlciAobm8gZXhpc3RpbmcgRGlzY29yZCBJRClcclxuICAgICAgICBpZiAoIWV4aXN0aW5nVXNlcikge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coYE5vIGV4aXN0aW5nIHVzZXIgd2l0aCBEaXNjb3JkIElEOiAke3Byb2ZpbGUuaWR9YClcclxuXHJcbiAgICAgICAgICAvLyBDaGVjayBpZiB1c2VyIGlzIGluIE1haW4gRGlzY29yZFxyXG4gICAgICAgICAgY29uc3QgaXNJbk1haW5EaXNjb3JkID0gYXdhaXQgaXNVc2VySW5NYWluRGlzY29yZChwcm9maWxlLmlkIGFzIHN0cmluZylcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGBVc2VyIGluIE1haW4gRGlzY29yZDogJHtpc0luTWFpbkRpc2NvcmR9YClcclxuXHJcbiAgICAgICAgICBpZiAoaXNJbk1haW5EaXNjb3JkKSB7XHJcbiAgICAgICAgICAgIC8vIEZvciBNYWluIERpc2NvcmQgbWVtYmVycywgc2V0IG5lZWRzT25ib2FyZGluZyB0byB0cnVlXHJcbiAgICAgICAgICAgIHRva2VuLm5lZWRzT25ib2FyZGluZyA9IHRydWVcclxuICAgICAgICAgICAgdG9rZW4uaXNJbk1haW5EaXNjb3JkID0gdHJ1ZVxyXG5cclxuICAgICAgICAgICAgLy8gR2V0IGRlcGFydG1lbnRzIGZyb20gTWFpbiBEaXNjb3JkXHJcbiAgICAgICAgICAgIGNvbnN0IGRlcGFydG1lbnRzID0gYXdhaXQgZ2V0VXNlckRlcGFydG1lbnRzRnJvbU1haW5EaXNjb3JkKHByb2ZpbGUuaWQgYXMgc3RyaW5nKVxyXG4gICAgICAgICAgICBpZiAoZGVwYXJ0bWVudHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgIHRva2VuLm1haW5EaXNjb3JkRGVwYXJ0bWVudHMgPSBkZXBhcnRtZW50c1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBVcGRhdGUgdGhlIHVzZXIgd2l0aCBuZWVkc09uYm9hcmRpbmcgZmxhZyBhbmQgRGlzY29yZCBJRFxyXG4gICAgICAgICAgICBhd2FpdCBwcmlzbWEudXNlci51cGRhdGUoe1xyXG4gICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBOdW1iZXIodG9rZW4uc3ViKSB9LFxyXG4gICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIG5lZWRzT25ib2FyZGluZzogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGRpc2NvcmRJZDogcHJvZmlsZS5pZCBhcyBzdHJpbmcsXHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBVcGRhdGVkIHVzZXIgJHt0b2tlbi5zdWJ9IHdpdGggbmVlZHNPbmJvYXJkaW5nPXRydWUgYW5kIGRpc2NvcmRJZD0ke3Byb2ZpbGUuaWR9YClcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIEZvciBGYW4gRGlzY29yZCBtZW1iZXJzLCBqdXN0IGNyZWF0ZSBhcyBBUFBMSUNBTlQgd2l0aCBubyBvbmJvYXJkaW5nXHJcbiAgICAgICAgICAgIHRva2VuLm5lZWRzT25ib2FyZGluZyA9IGZhbHNlXHJcbiAgICAgICAgICAgIHRva2VuLmlzSW5NYWluRGlzY29yZCA9IGZhbHNlXHJcblxyXG4gICAgICAgICAgICAvLyBVcGRhdGUgdGhlIHVzZXIgd2l0aCBEaXNjb3JkIElEXHJcbiAgICAgICAgICAgIGF3YWl0IHByaXNtYS51c2VyLnVwZGF0ZSh7XHJcbiAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IE51bWJlcih0b2tlbi5zdWIpIH0sXHJcbiAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgbmVlZHNPbmJvYXJkaW5nOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIGRpc2NvcmRJZDogcHJvZmlsZS5pZCBhcyBzdHJpbmcsXHJcbiAgICAgICAgICAgICAgICByb2xlOiBcIkFQUExJQ0FOVFwiLFxyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcclxuICAgICAgICAgICAgICBgVXBkYXRlZCB1c2VyICR7dG9rZW4uc3VifSB3aXRoIG5lZWRzT25ib2FyZGluZz1mYWxzZSwgcm9sZT1BUFBMSUNBTlQsIGFuZCBkaXNjb3JkSWQ9JHtwcm9maWxlLmlkfWAsXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgLy8gRXhpc3RpbmcgdXNlciAtIGdldCB0aGVpciBuZWVkc09uYm9hcmRpbmcgc3RhdHVzXHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhgRm91bmQgZXhpc3RpbmcgdXNlciB3aXRoIERpc2NvcmQgSUQ6ICR7cHJvZmlsZS5pZH1gKVxyXG5cclxuICAgICAgICAgIGNvbnN0IGRiVXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogTnVtYmVyKHRva2VuLnN1YikgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IG5lZWRzT25ib2FyZGluZzogdHJ1ZSwgcm9sZTogdHJ1ZSB9LFxyXG4gICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICBpZiAoZGJVc2VyKSB7XHJcbiAgICAgICAgICAgIHRva2VuLm5lZWRzT25ib2FyZGluZyA9IGRiVXNlci5uZWVkc09uYm9hcmRpbmdcclxuICAgICAgICAgICAgdG9rZW4ucm9sZSA9IGRiVXNlci5yb2xlXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBTZXQgdG9rZW4gZnJvbSBleGlzdGluZyB1c2VyOiBuZWVkc09uYm9hcmRpbmc9JHtkYlVzZXIubmVlZHNPbmJvYXJkaW5nfSwgcm9sZT0ke2RiVXNlci5yb2xlfWApXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gdG9rZW5cclxuICAgIH0sXHJcbiAgICBhc3luYyBzaWduSW4oeyB1c2VyLCBhY2NvdW50LCBwcm9maWxlIH0pIHtcclxuICAgICAgLy8gQWx3YXlzIGFsbG93IERpc2NvcmQgc2lnbi1pbnNcclxuICAgICAgaWYgKGFjY291bnQ/LnByb3ZpZGVyID09PSBcImRpc2NvcmRcIikge1xyXG4gICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIEZvciBjcmVkZW50aWFscyAoYWRtaW4pLCBjaGVjayBpZiB0aGUgdXNlciBoYXMgYWRtaW4gcm9sZVxyXG4gICAgICBpZiAoYWNjb3VudD8ucHJvdmlkZXIgPT09IFwiY3JlZGVudGlhbHNcIikge1xyXG4gICAgICAgIGNvbnN0IGRiVXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgd2hlcmU6IHsgaWQ6IE51bWJlci5wYXJzZUludCh1c2VyLmlkKSB9LFxyXG4gICAgICAgICAgc2VsZWN0OiB7IHJvbGU6IHRydWUgfSxcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICAvLyBVc2Ugb3VyIGhlbHBlciBmdW5jdGlvbnMgdG8gY2hlY2sgcGVybWlzc2lvbnNcclxuICAgICAgICByZXR1cm4gZGJVc2VyPy5yb2xlID8gaGFzQWRtaW5QZXJtaXNzaW9uKGRiVXNlci5yb2xlKSB8fCBoYXNTdGFmZlBlcm1pc3Npb24oZGJVc2VyLnJvbGUpIDogZmFsc2VcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICB9LFxyXG4gIH0sXHJcbiAgcGFnZXM6IHtcclxuICAgIHNpZ25JbjogXCIvYXV0aC9zaWduaW5cIixcclxuICAgIHNpZ25PdXQ6IFwiL2F1dGgvc2lnbm91dFwiLFxyXG4gICAgZXJyb3I6IFwiL2F1dGgvZXJyb3JcIixcclxuICB9LFxyXG4gIHNlc3Npb246IHtcclxuICAgIHN0cmF0ZWd5OiBcImp3dFwiLFxyXG4gIH0sXHJcbiAgZGVidWc6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcImRldmVsb3BtZW50XCIsXHJcbn1cclxuXHJcbmNvbnN0IGhhbmRsZXIgPSBOZXh0QXV0aChhdXRoT3B0aW9ucylcclxuXHJcbmV4cG9ydCB7IGhhbmRsZXIgYXMgR0VULCBoYW5kbGVyIGFzIFBPU1QgfVxyXG4iXSwibmFtZXMiOlsiTmV4dEF1dGgiLCJEaXNjb3JkUHJvdmlkZXIiLCJDcmVkZW50aWFsc1Byb3ZpZGVyIiwiUHJpc21hQWRhcHRlciIsInByaXNtYSIsImNvbXBhcmUiLCJpc1VzZXJJbk1haW5EaXNjb3JkIiwiZ2V0VXNlckRlcGFydG1lbnRzRnJvbU1haW5EaXNjb3JkIiwiaGFzQWRtaW5QZXJtaXNzaW9uIiwiaGFzU3RhZmZQZXJtaXNzaW9uIiwiYXV0aE9wdGlvbnMiLCJhZGFwdGVyIiwicHJvdmlkZXJzIiwiY2xpZW50SWQiLCJwcm9jZXNzIiwiZW52IiwiRElTQ09SRF9DTElFTlRfSUQiLCJjbGllbnRTZWNyZXQiLCJESVNDT1JEX0NMSUVOVF9TRUNSRVQiLCJhdXRob3JpemF0aW9uIiwicGFyYW1zIiwic2NvcGUiLCJwcm9maWxlIiwiaWQiLCJuYW1lIiwiZ2xvYmFsX25hbWUiLCJ1c2VybmFtZSIsImVtYWlsIiwiaW1hZ2UiLCJhdmF0YXIiLCJyb2xlIiwidXNlciIsInN1YiIsImNyZWRlbnRpYWxzIiwibGFiZWwiLCJ0eXBlIiwicGFzc3dvcmQiLCJhdXRob3JpemUiLCJmaW5kVW5pcXVlIiwid2hlcmUiLCJpc1Bhc3N3b3JkVmFsaWQiLCJ0b1N0cmluZyIsImNhbGxiYWNrcyIsInNlc3Npb24iLCJ0b2tlbiIsIk51bWJlciIsInBhcnNlSW50IiwibmVlZHNPbmJvYXJkaW5nIiwidW5kZWZpbmVkIiwiaXNJbk1haW5EaXNjb3JkIiwibWFpbkRpc2NvcmREZXBhcnRtZW50cyIsImp3dCIsImFjY291bnQiLCJ0cmlnZ2VyIiwiZGJVc2VyIiwic2VsZWN0IiwiY29uc29sZSIsImxvZyIsInByb3ZpZGVyIiwiZXhpc3RpbmdVc2VyIiwiZmluZEZpcnN0IiwiZGlzY29yZElkIiwibmV3VXNlciIsImRlcGFydG1lbnRzIiwibGVuZ3RoIiwidXBkYXRlIiwiZGF0YSIsInNpZ25JbiIsInBhZ2VzIiwic2lnbk91dCIsImVycm9yIiwic3RyYXRlZ3kiLCJkZWJ1ZyIsImhhbmRsZXIiLCJHRVQiLCJQT1NUIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/auth/[...nextauth]/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/main-discord.ts":
/*!*****************************!*\
  !*** ./lib/main-discord.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getUserDepartmentsFromMainDiscord: () => (/* binding */ getUserDepartmentsFromMainDiscord),\n/* harmony export */   hasWhitelistedRoleInFanDiscord: () => (/* binding */ hasWhitelistedRoleInFanDiscord),\n/* harmony export */   isUserInMainDiscord: () => (/* binding */ isUserInMainDiscord),\n/* harmony export */   syncUserDepartmentFromMainDiscord: () => (/* binding */ syncUserDepartmentFromMainDiscord)\n/* harmony export */ });\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./lib/prisma.ts\");\n\n/**\r\n * Check if a user is a member of the Main Discord server\r\n * @param discordId The Discord ID of the user to check\r\n * @returns Boolean indicating if the user is in the Main Discord\r\n */ async function isUserInMainDiscord(discordId) {\n    try {\n        // Skip the check in development if no token is provided\n        if ( true && !process.env.MAIN_DISCORD_BOT_TOKEN) {\n            console.log(\"Development mode: Simulating Main Discord membership check\");\n            return true;\n        }\n        const mainDiscordGuildId = process.env.MAIN_DISCORD_GUILD_ID;\n        const mainDiscordBotToken = process.env.MAIN_DISCORD_BOT_TOKEN;\n        if (!mainDiscordGuildId || !mainDiscordBotToken) {\n            console.error(\"Missing Main Discord configuration\");\n            return false;\n        }\n        // Make a request to the Discord API to check if the user is in the guild\n        const response = await fetch(`https://discord.com/api/v10/guilds/${mainDiscordGuildId}/members/${discordId}`, {\n            headers: {\n                Authorization: `Bot ${mainDiscordBotToken}`\n            },\n            cache: \"no-store\"\n        });\n        // If the response is 200, the user is in the guild\n        return response.status === 200;\n    } catch (error) {\n        console.error(\"Error checking Main Discord membership:\", error);\n        return false;\n    }\n}\n// Map of Discord role IDs to department names\nconst MAIN_DISCORD_DEPARTMENT_ROLES = {\n    \"1254493228368138300\": \"BSFR\",\n    \"1209491889053638676\": \"RNR\",\n    \"1254480335782154390\": \"BSO\",\n    \"1254491794012508251\": \"MPD\",\n    \"1254475337669017600\": \"FHP\",\n    \"1254497904249536622\": \"COMMS\",\n    \"1254480328710684794\": \"FWC\",\n    \"1254497942564241458\": \"CIV\",\n    \"1144075648885870654\": \"DEV\"\n};\n/**\r\n * Get the departments a user has based on their roles in the Main Discord\r\n * @param discordId The Discord ID of the user\r\n * @returns Array of department names the user has roles for\r\n */ async function getUserDepartmentsFromMainDiscord(discordId) {\n    try {\n        // Skip the check in development if no token is provided\n        if ( true && !process.env.MAIN_DISCORD_BOT_TOKEN) {\n            console.log(\"Development mode: Simulating Main Discord departments\");\n            return [\n                \"BSO\",\n                \"FHP\"\n            ] // Return some example departments\n            ;\n        }\n        const mainDiscordGuildId = process.env.MAIN_DISCORD_GUILD_ID;\n        const mainDiscordBotToken = process.env.MAIN_DISCORD_BOT_TOKEN;\n        if (!mainDiscordGuildId || !mainDiscordBotToken) {\n            console.error(\"Missing Main Discord configuration\");\n            return [];\n        }\n        // Make a request to the Discord API to get the user's roles\n        const response = await fetch(`https://discord.com/api/v10/guilds/${mainDiscordGuildId}/members/${discordId}`, {\n            headers: {\n                Authorization: `Bot ${mainDiscordBotToken}`\n            },\n            cache: \"no-store\"\n        });\n        if (!response.ok) {\n            return [];\n        }\n        const data = await response.json();\n        const userRoles = data.roles || [];\n        // Map the roles to departments\n        const departments = userRoles.map((roleId)=>MAIN_DISCORD_DEPARTMENT_ROLES[roleId]).filter(Boolean);\n        return [\n            ...new Set(departments)\n        ] // Remove duplicates\n        ;\n    } catch (error) {\n        console.error(\"Error getting Main Discord departments:\", error);\n        return [];\n    }\n}\n/**\r\n * Sync a user's department from the Main Discord server\r\n * @param userId The user ID in the database\r\n * @param discordId The Discord ID of the user\r\n * @returns Boolean indicating if the sync was successful\r\n */ async function syncUserDepartmentFromMainDiscord(userId, discordId) {\n    try {\n        // Get the user's departments from the Main Discord\n        const departments = await getUserDepartmentsFromMainDiscord(discordId);\n        if (departments.length === 0) {\n            console.log(`No departments found for user ${userId} in Main Discord`);\n            return false;\n        }\n        // Use the first department as the primary department\n        const primaryDepartment = departments[0];\n        // Update the user's department in the database\n        await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.update({\n            where: {\n                id: userId\n            },\n            data: {\n                department: primaryDepartment\n            }\n        });\n        console.log(`Updated user ${userId} department to ${primaryDepartment}`);\n        return true;\n    } catch (error) {\n        console.error(`Error syncing department for user ${userId}:`, error);\n        return false;\n    }\n}\n/**\r\n * Check if a user has the Whitelisted role in the Fan Discord\r\n * @param discordId The Discord ID of the user\r\n * @returns Boolean indicating if the user has the Whitelisted role\r\n */ async function hasWhitelistedRoleInFanDiscord(discordId) {\n    try {\n        // Skip the check in development if no token is provided\n        if ( true && !process.env.DISCORD_BOT_TOKEN) {\n            console.log(\"Development mode: Simulating Fan Discord whitelist check\");\n            return true;\n        }\n        const fanDiscordGuildId = process.env.DISCORD_GUILD_ID;\n        const fanDiscordBotToken = process.env.DISCORD_BOT_TOKEN;\n        // This should be the actual role ID for the \"Whitelisted\" role in your Fan Discord\n        const WHITELISTED_ROLE_ID = process.env.FAN_DISCORD_WHITELISTED_ROLE_ID || \"1253761018769969244\" // Replace with actual ID\n        ;\n        if (!fanDiscordGuildId || !fanDiscordBotToken) {\n            console.error(\"Missing Fan Discord configuration\");\n            return false;\n        }\n        // Make a request to the Discord API to get the user's roles in the Fan Discord\n        const response = await fetch(`https://discord.com/api/v10/guilds/${fanDiscordGuildId}/members/${discordId}`, {\n            headers: {\n                Authorization: `Bot ${fanDiscordBotToken}`\n            },\n            cache: \"no-store\"\n        });\n        if (!response.ok) {\n            return false;\n        }\n        const data = await response.json();\n        const userRoles = data.roles || [];\n        // Check if the user has the Whitelisted role\n        return userRoles.includes(WHITELISTED_ROLE_ID);\n    } catch (error) {\n        console.error(\"Error checking Fan Discord whitelist:\", error);\n        return false;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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bUNBQW1DLEVBQUU2QixrQkFBa0IsU0FBUyxFQUFFeEMsV0FBVyxFQUFFO1lBQzNHWSxTQUFTO2dCQUNQQyxlQUFlLENBQUMsSUFBSSxFQUFFNkIsb0JBQW9CO1lBQzVDO1lBQ0E1QixPQUFPO1FBQ1Q7UUFFQSxJQUFJLENBQUNKLFNBQVNRLEVBQUUsRUFBRTtZQUNoQixPQUFPO1FBQ1Q7UUFFQSxNQUFNQyxPQUFPLE1BQU1ULFNBQVNVLElBQUk7UUFDaEMsTUFBTUMsWUFBWUYsS0FBS0csS0FBSyxJQUFJLEVBQUU7UUFFbEMsNkNBQTZDO1FBQzdDLE9BQU9ELFVBQVV3QixRQUFRLENBQUNGO0lBQzVCLEVBQUUsT0FBT2xDLE9BQU87UUFDZEwsUUFBUUssS0FBSyxDQUFDLHlDQUF5Q0E7UUFDdkQsT0FBTztJQUNUO0FBQ0YiLCJzb3VyY2VzIjpbIkM6XFx4YW1wcFxcbm9kZWpzLWFwcHNcXGNvbW11bml0eS1mb3J1bVxcbGliXFxtYWluLWRpc2NvcmQudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcHJpc21hIH0gZnJvbSBcIkAvbGliL3ByaXNtYVwiXHJcblxyXG4vKipcclxuICogQ2hlY2sgaWYgYSB1c2VyIGlzIGEgbWVtYmVyIG9mIHRoZSBNYWluIERpc2NvcmQgc2VydmVyXHJcbiAqIEBwYXJhbSBkaXNjb3JkSWQgVGhlIERpc2NvcmQgSUQgb2YgdGhlIHVzZXIgdG8gY2hlY2tcclxuICogQHJldHVybnMgQm9vbGVhbiBpbmRpY2F0aW5nIGlmIHRoZSB1c2VyIGlzIGluIHRoZSBNYWluIERpc2NvcmRcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpc1VzZXJJbk1haW5EaXNjb3JkKGRpc2NvcmRJZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIFNraXAgdGhlIGNoZWNrIGluIGRldmVsb3BtZW50IGlmIG5vIHRva2VuIGlzIHByb3ZpZGVkXHJcbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09IFwiZGV2ZWxvcG1lbnRcIiAmJiAhcHJvY2Vzcy5lbnYuTUFJTl9ESVNDT1JEX0JPVF9UT0tFTikge1xyXG4gICAgICBjb25zb2xlLmxvZyhcIkRldmVsb3BtZW50IG1vZGU6IFNpbXVsYXRpbmcgTWFpbiBEaXNjb3JkIG1lbWJlcnNoaXAgY2hlY2tcIilcclxuICAgICAgcmV0dXJuIHRydWVcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBtYWluRGlzY29yZEd1aWxkSWQgPSBwcm9jZXNzLmVudi5NQUlOX0RJU0NPUkRfR1VJTERfSURcclxuICAgIGNvbnN0IG1haW5EaXNjb3JkQm90VG9rZW4gPSBwcm9jZXNzLmVudi5NQUlOX0RJU0NPUkRfQk9UX1RPS0VOXHJcblxyXG4gICAgaWYgKCFtYWluRGlzY29yZEd1aWxkSWQgfHwgIW1haW5EaXNjb3JkQm90VG9rZW4pIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIk1pc3NpbmcgTWFpbiBEaXNjb3JkIGNvbmZpZ3VyYXRpb25cIilcclxuICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICB9XHJcblxyXG4gICAgLy8gTWFrZSBhIHJlcXVlc3QgdG8gdGhlIERpc2NvcmQgQVBJIHRvIGNoZWNrIGlmIHRoZSB1c2VyIGlzIGluIHRoZSBndWlsZFxyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgaHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvdjEwL2d1aWxkcy8ke21haW5EaXNjb3JkR3VpbGRJZH0vbWVtYmVycy8ke2Rpc2NvcmRJZH1gLCB7XHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBBdXRob3JpemF0aW9uOiBgQm90ICR7bWFpbkRpc2NvcmRCb3RUb2tlbn1gLFxyXG4gICAgICB9LFxyXG4gICAgICBjYWNoZTogXCJuby1zdG9yZVwiLFxyXG4gICAgfSlcclxuXHJcbiAgICAvLyBJZiB0aGUgcmVzcG9uc2UgaXMgMjAwLCB0aGUgdXNlciBpcyBpbiB0aGUgZ3VpbGRcclxuICAgIHJldHVybiByZXNwb25zZS5zdGF0dXMgPT09IDIwMFxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgY2hlY2tpbmcgTWFpbiBEaXNjb3JkIG1lbWJlcnNoaXA6XCIsIGVycm9yKVxyXG4gICAgcmV0dXJuIGZhbHNlXHJcbiAgfVxyXG59XHJcblxyXG4vLyBNYXAgb2YgRGlzY29yZCByb2xlIElEcyB0byBkZXBhcnRtZW50IG5hbWVzXHJcbmNvbnN0IE1BSU5fRElTQ09SRF9ERVBBUlRNRU5UX1JPTEVTOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xyXG4gIFwiMTI1NDQ5MzIyODM2ODEzODMwMFwiOiBcIkJTRlJcIixcclxuICBcIjEyMDk0OTE4ODkwNTM2Mzg2NzZcIjogXCJSTlJcIixcclxuICBcIjEyNTQ0ODAzMzU3ODIxNTQzOTBcIjogXCJCU09cIixcclxuICBcIjEyNTQ0OTE3OTQwMTI1MDgyNTFcIjogXCJNUERcIixcclxuICBcIjEyNTQ0NzUzMzc2NjkwMTc2MDBcIjogXCJGSFBcIixcclxuICBcIjEyNTQ0OTc5MDQyNDk1MzY2MjJcIjogXCJDT01NU1wiLFxyXG4gIFwiMTI1NDQ4MDMyODcxMDY4NDc5NFwiOiBcIkZXQ1wiLFxyXG4gIFwiMTI1NDQ5Nzk0MjU2NDI0MTQ1OFwiOiBcIkNJVlwiLFxyXG4gIFwiMTE0NDA3NTY0ODg4NTg3MDY1NFwiOiBcIkRFVlwiLFxyXG59XHJcblxyXG4vKipcclxuICogR2V0IHRoZSBkZXBhcnRtZW50cyBhIHVzZXIgaGFzIGJhc2VkIG9uIHRoZWlyIHJvbGVzIGluIHRoZSBNYWluIERpc2NvcmRcclxuICogQHBhcmFtIGRpc2NvcmRJZCBUaGUgRGlzY29yZCBJRCBvZiB0aGUgdXNlclxyXG4gKiBAcmV0dXJucyBBcnJheSBvZiBkZXBhcnRtZW50IG5hbWVzIHRoZSB1c2VyIGhhcyByb2xlcyBmb3JcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRVc2VyRGVwYXJ0bWVudHNGcm9tTWFpbkRpc2NvcmQoZGlzY29yZElkOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZ1tdPiB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIFNraXAgdGhlIGNoZWNrIGluIGRldmVsb3BtZW50IGlmIG5vIHRva2VuIGlzIHByb3ZpZGVkXHJcbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09IFwiZGV2ZWxvcG1lbnRcIiAmJiAhcHJvY2Vzcy5lbnYuTUFJTl9ESVNDT1JEX0JPVF9UT0tFTikge1xyXG4gICAgICBjb25zb2xlLmxvZyhcIkRldmVsb3BtZW50IG1vZGU6IFNpbXVsYXRpbmcgTWFpbiBEaXNjb3JkIGRlcGFydG1lbnRzXCIpXHJcbiAgICAgIHJldHVybiBbXCJCU09cIiwgXCJGSFBcIl0gLy8gUmV0dXJuIHNvbWUgZXhhbXBsZSBkZXBhcnRtZW50c1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IG1haW5EaXNjb3JkR3VpbGRJZCA9IHByb2Nlc3MuZW52Lk1BSU5fRElTQ09SRF9HVUlMRF9JRFxyXG4gICAgY29uc3QgbWFpbkRpc2NvcmRCb3RUb2tlbiA9IHByb2Nlc3MuZW52Lk1BSU5fRElTQ09SRF9CT1RfVE9LRU5cclxuXHJcbiAgICBpZiAoIW1haW5EaXNjb3JkR3VpbGRJZCB8fCAhbWFpbkRpc2NvcmRCb3RUb2tlbikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiTWlzc2luZyBNYWluIERpc2NvcmQgY29uZmlndXJhdGlvblwiKVxyXG4gICAgICByZXR1cm4gW11cclxuICAgIH1cclxuXHJcbiAgICAvLyBNYWtlIGEgcmVxdWVzdCB0byB0aGUgRGlzY29yZCBBUEkgdG8gZ2V0IHRoZSB1c2VyJ3Mgcm9sZXNcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYGh0dHBzOi8vZGlzY29yZC5jb20vYXBpL3YxMC9ndWlsZHMvJHttYWluRGlzY29yZEd1aWxkSWR9L21lbWJlcnMvJHtkaXNjb3JkSWR9YCwge1xyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgQXV0aG9yaXphdGlvbjogYEJvdCAke21haW5EaXNjb3JkQm90VG9rZW59YCxcclxuICAgICAgfSxcclxuICAgICAgY2FjaGU6IFwibm8tc3RvcmVcIixcclxuICAgIH0pXHJcblxyXG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xyXG4gICAgICByZXR1cm4gW11cclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpXHJcbiAgICBjb25zdCB1c2VyUm9sZXMgPSBkYXRhLnJvbGVzIHx8IFtdXHJcblxyXG4gICAgLy8gTWFwIHRoZSByb2xlcyB0byBkZXBhcnRtZW50c1xyXG4gICAgY29uc3QgZGVwYXJ0bWVudHMgPSB1c2VyUm9sZXMubWFwKChyb2xlSWQ6IHN0cmluZykgPT4gTUFJTl9ESVNDT1JEX0RFUEFSVE1FTlRfUk9MRVNbcm9sZUlkXSkuZmlsdGVyKEJvb2xlYW4pXHJcblxyXG4gICAgcmV0dXJuIFsuLi5uZXcgU2V0KGRlcGFydG1lbnRzKV0gLy8gUmVtb3ZlIGR1cGxpY2F0ZXNcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGdldHRpbmcgTWFpbiBEaXNjb3JkIGRlcGFydG1lbnRzOlwiLCBlcnJvcilcclxuICAgIHJldHVybiBbXVxyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFN5bmMgYSB1c2VyJ3MgZGVwYXJ0bWVudCBmcm9tIHRoZSBNYWluIERpc2NvcmQgc2VydmVyXHJcbiAqIEBwYXJhbSB1c2VySWQgVGhlIHVzZXIgSUQgaW4gdGhlIGRhdGFiYXNlXHJcbiAqIEBwYXJhbSBkaXNjb3JkSWQgVGhlIERpc2NvcmQgSUQgb2YgdGhlIHVzZXJcclxuICogQHJldHVybnMgQm9vbGVhbiBpbmRpY2F0aW5nIGlmIHRoZSBzeW5jIHdhcyBzdWNjZXNzZnVsXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3luY1VzZXJEZXBhcnRtZW50RnJvbU1haW5EaXNjb3JkKHVzZXJJZDogbnVtYmVyLCBkaXNjb3JkSWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBHZXQgdGhlIHVzZXIncyBkZXBhcnRtZW50cyBmcm9tIHRoZSBNYWluIERpc2NvcmRcclxuICAgIGNvbnN0IGRlcGFydG1lbnRzID0gYXdhaXQgZ2V0VXNlckRlcGFydG1lbnRzRnJvbU1haW5EaXNjb3JkKGRpc2NvcmRJZClcclxuXHJcbiAgICBpZiAoZGVwYXJ0bWVudHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBObyBkZXBhcnRtZW50cyBmb3VuZCBmb3IgdXNlciAke3VzZXJJZH0gaW4gTWFpbiBEaXNjb3JkYClcclxuICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICB9XHJcblxyXG4gICAgLy8gVXNlIHRoZSBmaXJzdCBkZXBhcnRtZW50IGFzIHRoZSBwcmltYXJ5IGRlcGFydG1lbnRcclxuICAgIGNvbnN0IHByaW1hcnlEZXBhcnRtZW50ID0gZGVwYXJ0bWVudHNbMF1cclxuXHJcbiAgICAvLyBVcGRhdGUgdGhlIHVzZXIncyBkZXBhcnRtZW50IGluIHRoZSBkYXRhYmFzZVxyXG4gICAgYXdhaXQgcHJpc21hLnVzZXIudXBkYXRlKHtcclxuICAgICAgd2hlcmU6IHsgaWQ6IHVzZXJJZCB9LFxyXG4gICAgICBkYXRhOiB7IGRlcGFydG1lbnQ6IHByaW1hcnlEZXBhcnRtZW50IH0sXHJcbiAgICB9KVxyXG5cclxuICAgIGNvbnNvbGUubG9nKGBVcGRhdGVkIHVzZXIgJHt1c2VySWR9IGRlcGFydG1lbnQgdG8gJHtwcmltYXJ5RGVwYXJ0bWVudH1gKVxyXG4gICAgcmV0dXJuIHRydWVcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihgRXJyb3Igc3luY2luZyBkZXBhcnRtZW50IGZvciB1c2VyICR7dXNlcklkfTpgLCBlcnJvcilcclxuICAgIHJldHVybiBmYWxzZVxyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIENoZWNrIGlmIGEgdXNlciBoYXMgdGhlIFdoaXRlbGlzdGVkIHJvbGUgaW4gdGhlIEZhbiBEaXNjb3JkXHJcbiAqIEBwYXJhbSBkaXNjb3JkSWQgVGhlIERpc2NvcmQgSUQgb2YgdGhlIHVzZXJcclxuICogQHJldHVybnMgQm9vbGVhbiBpbmRpY2F0aW5nIGlmIHRoZSB1c2VyIGhhcyB0aGUgV2hpdGVsaXN0ZWQgcm9sZVxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhc1doaXRlbGlzdGVkUm9sZUluRmFuRGlzY29yZChkaXNjb3JkSWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBTa2lwIHRoZSBjaGVjayBpbiBkZXZlbG9wbWVudCBpZiBubyB0b2tlbiBpcyBwcm92aWRlZFxyXG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcImRldmVsb3BtZW50XCIgJiYgIXByb2Nlc3MuZW52LkRJU0NPUkRfQk9UX1RPS0VOKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwiRGV2ZWxvcG1lbnQgbW9kZTogU2ltdWxhdGluZyBGYW4gRGlzY29yZCB3aGl0ZWxpc3QgY2hlY2tcIilcclxuICAgICAgcmV0dXJuIHRydWVcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBmYW5EaXNjb3JkR3VpbGRJZCA9IHByb2Nlc3MuZW52LkRJU0NPUkRfR1VJTERfSURcclxuICAgIGNvbnN0IGZhbkRpc2NvcmRCb3RUb2tlbiA9IHByb2Nlc3MuZW52LkRJU0NPUkRfQk9UX1RPS0VOXHJcblxyXG4gICAgLy8gVGhpcyBzaG91bGQgYmUgdGhlIGFjdHVhbCByb2xlIElEIGZvciB0aGUgXCJXaGl0ZWxpc3RlZFwiIHJvbGUgaW4geW91ciBGYW4gRGlzY29yZFxyXG4gICAgY29uc3QgV0hJVEVMSVNURURfUk9MRV9JRCA9IHByb2Nlc3MuZW52LkZBTl9ESVNDT1JEX1dISVRFTElTVEVEX1JPTEVfSUQgfHwgXCIxMjUzNzYxMDE4NzY5OTY5MjQ0XCIgLy8gUmVwbGFjZSB3aXRoIGFjdHVhbCBJRFxyXG5cclxuICAgIGlmICghZmFuRGlzY29yZEd1aWxkSWQgfHwgIWZhbkRpc2NvcmRCb3RUb2tlbikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiTWlzc2luZyBGYW4gRGlzY29yZCBjb25maWd1cmF0aW9uXCIpXHJcbiAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgfVxyXG5cclxuICAgIC8vIE1ha2UgYSByZXF1ZXN0IHRvIHRoZSBEaXNjb3JkIEFQSSB0byBnZXQgdGhlIHVzZXIncyByb2xlcyBpbiB0aGUgRmFuIERpc2NvcmRcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYGh0dHBzOi8vZGlzY29yZC5jb20vYXBpL3YxMC9ndWlsZHMvJHtmYW5EaXNjb3JkR3VpbGRJZH0vbWVtYmVycy8ke2Rpc2NvcmRJZH1gLCB7XHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBBdXRob3JpemF0aW9uOiBgQm90ICR7ZmFuRGlzY29yZEJvdFRva2VufWAsXHJcbiAgICAgIH0sXHJcbiAgICAgIGNhY2hlOiBcIm5vLXN0b3JlXCIsXHJcbiAgICB9KVxyXG5cclxuICAgIGlmICghcmVzcG9uc2Uub2spIHtcclxuICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxyXG4gICAgY29uc3QgdXNlclJvbGVzID0gZGF0YS5yb2xlcyB8fCBbXVxyXG5cclxuICAgIC8vIENoZWNrIGlmIHRoZSB1c2VyIGhhcyB0aGUgV2hpdGVsaXN0ZWQgcm9sZVxyXG4gICAgcmV0dXJuIHVzZXJSb2xlcy5pbmNsdWRlcyhXSElURUxJU1RFRF9ST0xFX0lEKVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgY2hlY2tpbmcgRmFuIERpc2NvcmQgd2hpdGVsaXN0OlwiLCBlcnJvcilcclxuICAgIHJldHVybiBmYWxzZVxyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsicHJpc21hIiwiaXNVc2VySW5NYWluRGlzY29yZCIsImRpc2NvcmRJZCIsInByb2Nlc3MiLCJlbnYiLCJNQUlOX0RJU0NPUkRfQk9UX1RPS0VOIiwiY29uc29sZSIsImxvZyIsIm1haW5EaXNjb3JkR3VpbGRJZCIsIk1BSU5fRElTQ09SRF9HVUlMRF9JRCIsIm1haW5EaXNjb3JkQm90VG9rZW4iLCJlcnJvciIsInJlc3BvbnNlIiwiZmV0Y2giLCJoZWFkZXJzIiwiQXV0aG9yaXphdGlvbiIsImNhY2hlIiwic3RhdHVzIiwiTUFJTl9ESVNDT1JEX0RFUEFSVE1FTlRfUk9MRVMiLCJnZXRVc2VyRGVwYXJ0bWVudHNGcm9tTWFpbkRpc2NvcmQiLCJvayIsImRhdGEiLCJqc29uIiwidXNlclJvbGVzIiwicm9sZXMiLCJkZXBhcnRtZW50cyIsIm1hcCIsInJvbGVJZCIsImZpbHRlciIsIkJvb2xlYW4iLCJTZXQiLCJzeW5jVXNlckRlcGFydG1lbnRGcm9tTWFpbkRpc2NvcmQiLCJ1c2VySWQiLCJsZW5ndGgiLCJwcmltYXJ5RGVwYXJ0bWVudCIsInVzZXIiLCJ1cGRhdGUiLCJ3aGVyZSIsImlkIiwiZGVwYXJ0bWVudCIsImhhc1doaXRlbGlzdGVkUm9sZUluRmFuRGlzY29yZCIsIkRJU0NPUkRfQk9UX1RPS0VOIiwiZmFuRGlzY29yZEd1aWxkSWQiLCJESVNDT1JEX0dVSUxEX0lEIiwiZmFuRGlzY29yZEJvdFRva2VuIiwiV0hJVEVMSVNURURfUk9MRV9JRCIsIkZBTl9ESVNDT1JEX1dISVRFTElTVEVEX1JPTEVfSUQiLCJpbmNsdWRlcyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/main-discord.ts\n");

/***/ }),

/***/ "(rsc)/./lib/prisma.ts":
/*!***********************!*\
  !*** ./lib/prisma.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n// lib/prisma.ts - Your current setup works fine\n\nconst prismaClientSingleton = ()=>{\n    return new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient();\n};\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? prismaClientSingleton();\nif (true) globalForPrisma.prisma = prisma;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvcHJpc21hLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLGdEQUFnRDtBQUNIO0FBRTdDLE1BQU1DLHdCQUF3QjtJQUM1QixPQUFPLElBQUlELHdEQUFZQTtBQUN6QjtBQUlBLE1BQU1FLGtCQUFrQkM7QUFJakIsTUFBTUMsU0FBU0YsZ0JBQWdCRSxNQUFNLElBQUlILHdCQUF1QjtBQUV2RSxJQUFJSSxJQUFxQyxFQUFFSCxnQkFBZ0JFLE1BQU0sR0FBR0EiLCJzb3VyY2VzIjpbIkM6XFx4YW1wcFxcbm9kZWpzLWFwcHNcXGNvbW11bml0eS1mb3J1bVxcbGliXFxwcmlzbWEudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gbGliL3ByaXNtYS50cyAtIFlvdXIgY3VycmVudCBzZXR1cCB3b3JrcyBmaW5lXHJcbmltcG9ydCB7IFByaXNtYUNsaWVudCB9IGZyb20gXCJAcHJpc21hL2NsaWVudFwiXHJcblxyXG5jb25zdCBwcmlzbWFDbGllbnRTaW5nbGV0b24gPSAoKSA9PiB7XHJcbiAgcmV0dXJuIG5ldyBQcmlzbWFDbGllbnQoKVxyXG59XHJcblxyXG50eXBlIFByaXNtYUNsaWVudFNpbmdsZXRvbiA9IFJldHVyblR5cGU8dHlwZW9mIHByaXNtYUNsaWVudFNpbmdsZXRvbj5cclxuXHJcbmNvbnN0IGdsb2JhbEZvclByaXNtYSA9IGdsb2JhbFRoaXMgYXMgdW5rbm93biBhcyB7XHJcbiAgcHJpc21hOiBQcmlzbWFDbGllbnRTaW5nbGV0b24gfCB1bmRlZmluZWRcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IHByaXNtYSA9IGdsb2JhbEZvclByaXNtYS5wcmlzbWEgPz8gcHJpc21hQ2xpZW50U2luZ2xldG9uKClcclxuXHJcbmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIpIGdsb2JhbEZvclByaXNtYS5wcmlzbWEgPSBwcmlzbWEiXSwibmFtZXMiOlsiUHJpc21hQ2xpZW50IiwicHJpc21hQ2xpZW50U2luZ2xldG9uIiwiZ2xvYmFsRm9yUHJpc21hIiwiZ2xvYmFsVGhpcyIsInByaXNtYSIsInByb2Nlc3MiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/prisma.ts\n");

/***/ }),

/***/ "(rsc)/./lib/roles.ts":
/*!**********************!*\
  !*** ./lib/roles.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ADMIN_ROLES: () => (/* binding */ ADMIN_ROLES),\n/* harmony export */   BASIC_ROLES: () => (/* binding */ BASIC_ROLES),\n/* harmony export */   DISCORD_ASSIGNABLE_ROLES: () => (/* binding */ DISCORD_ASSIGNABLE_ROLES),\n/* harmony export */   DISCORD_ROLES: () => (/* binding */ DISCORD_ROLES),\n/* harmony export */   ROLE_HIERARCHY: () => (/* binding */ ROLE_HIERARCHY),\n/* harmony export */   STAFF_ROLES: () => (/* binding */ STAFF_ROLES),\n/* harmony export */   canAccessApplicationType: () => (/* binding */ canAccessApplicationType),\n/* harmony export */   canApproveUnderage: () => (/* binding */ canApproveUnderage),\n/* harmony export */   canAssignRole: () => (/* binding */ canAssignRole),\n/* harmony export */   canOverrideRnRDecisions: () => (/* binding */ canOverrideRnRDecisions),\n/* harmony export */   fetchDiscordRoles: () => (/* binding */ fetchDiscordRoles),\n/* harmony export */   formatRoleDisplay: () => (/* binding */ formatRoleDisplay),\n/* harmony export */   getAssignableRoles: () => (/* binding */ getAssignableRoles),\n/* harmony export */   getAvailableDepartmentsForRole: () => (/* binding */ getAvailableDepartmentsForRole),\n/* harmony export */   hasAdminPermission: () => (/* binding */ hasAdminPermission),\n/* harmony export */   hasRnRPermission: () => (/* binding */ hasRnRPermission),\n/* harmony export */   hasStaffPermission: () => (/* binding */ hasStaffPermission),\n/* harmony export */   isWebmaster: () => (/* binding */ isWebmaster),\n/* harmony export */   mapDiscordRoleToAppRole: () => (/* binding */ mapDiscordRoleToAppRole),\n/* harmony export */   shouldPreserveRole: () => (/* binding */ shouldPreserveRole),\n/* harmony export */   syncUserRoleFromDiscord: () => (/* binding */ syncUserRoleFromDiscord)\n/* harmony export */ });\n// Role hierarchy from highest to lowest\nconst ROLE_HIERARCHY = [\n    \"WEBMASTER\",\n    \"HEAD_ADMIN\",\n    \"SENIOR_ADMIN\",\n    \"SPECIAL_ADVISOR\",\n    \"ADMIN\",\n    \"JUNIOR_ADMIN\",\n    \"SENIOR_STAFF\",\n    \"STAFF\",\n    \"STAFF_IN_TRAINING\",\n    \"MEMBER\",\n    \"APPLICANT\"\n];\n// Group roles by permission level\nconst ADMIN_ROLES = [\n    \"WEBMASTER\",\n    \"HEAD_ADMIN\",\n    \"SENIOR_ADMIN\",\n    \"SPECIAL_ADVISOR\",\n    \"ADMIN\"\n];\nconst STAFF_ROLES = [\n    \"JUNIOR_ADMIN\",\n    \"SENIOR_STAFF\",\n    \"STAFF\"\n];\nconst BASIC_ROLES = [\n    \"STAFF_IN_TRAINING\",\n    \"MEMBER\",\n    \"APPLICANT\"\n];\n// Roles that can be automatically assigned through Discord\nconst DISCORD_ASSIGNABLE_ROLES = [\n    \"JUNIOR_ADMIN\",\n    \"SENIOR_STAFF\",\n    \"STAFF\",\n    \"STAFF_IN_TRAINING\",\n    \"MEMBER\",\n    \"APPLICANT\"\n];\n// Check if a user has admin permissions\nfunction hasAdminPermission(role) {\n    return role ? ADMIN_ROLES.includes(role) : false;\n}\n// Check if a user has staff permissions\nfunction hasStaffPermission(role) {\n    return role ? ADMIN_ROLES.includes(role) || STAFF_ROLES.includes(role) : false;\n}\n// Check if a user is a webmaster (special permissions)\nfunction isWebmaster(role) {\n    return role === \"WEBMASTER\";\n}\n// Check if a user can assign a specific role\nfunction canAssignRole(userRole, targetRole) {\n    if (!userRole || !targetRole) return false;\n    // Webmaster can assign any role\n    if (userRole === \"WEBMASTER\") return true;\n    // Get the indices in the hierarchy (lower index = higher rank)\n    const userRoleIndex = ROLE_HIERARCHY.indexOf(userRole);\n    const targetRoleIndex = ROLE_HIERARCHY.indexOf(targetRole);\n    // User can only assign roles that are lower in the hierarchy (higher index)\n    return userRoleIndex < targetRoleIndex;\n}\n// Get available roles that a user can assign\nfunction getAssignableRoles(userRole) {\n    if (!userRole) return [];\n    // Webmaster can assign any role except webmaster itself\n    if (userRole === \"WEBMASTER\") {\n        return ROLE_HIERARCHY.filter((role)=>role !== \"WEBMASTER\");\n    }\n    // HEAD_ADMIN can assign any role except WEBMASTER\n    if (userRole === \"HEAD_ADMIN\") {\n        return ROLE_HIERARCHY.filter((role)=>role !== \"WEBMASTER\");\n    }\n    // SENIOR_ADMIN can assign roles up to ADMIN\n    if (userRole === \"SENIOR_ADMIN\") {\n        return ROLE_HIERARCHY.filter((role)=>![\n                \"WEBMASTER\",\n                \"HEAD_ADMIN\",\n                \"SENIOR_ADMIN\"\n            ].includes(role));\n    }\n    // SPECIAL_ADVISOR and ADMIN can assign roles up to JUNIOR_ADMIN\n    if (userRole === \"SPECIAL_ADVISOR\" || userRole === \"ADMIN\") {\n        return ROLE_HIERARCHY.filter((role)=>![\n                \"WEBMASTER\",\n                \"HEAD_ADMIN\",\n                \"SENIOR_ADMIN\",\n                \"SPECIAL_ADVISOR\",\n                \"ADMIN\"\n            ].includes(role));\n    }\n    // JUNIOR_ADMIN can assign basic roles\n    if (userRole === \"JUNIOR_ADMIN\") {\n        return BASIC_ROLES;\n    }\n    // Other roles can't assign roles\n    return [];\n}\n// Format role for display\nfunction formatRoleDisplay(role) {\n    return role.split(\"_\").map((word)=>word.charAt(0).toUpperCase() + word.slice(1).toLowerCase()).join(\" \");\n}\n// Discord role IDs - only for roles that can be automatically assigned\nconst DISCORD_ROLES = {\n    // Staff level roles\n    JUNIOR_ADMIN: \"1209567769826295899\",\n    SENIOR_STAFF: \"1209567769826295899\",\n    STAFF: \"1209852842727313438\",\n    // Basic level roles\n    STAFF_IN_TRAINING: \"1209852843574693918\",\n    MEMBER: \"1253761018769969244\",\n    APPLICANT: \"1253758031112568832\"\n};\n// Map Discord roles to application roles\nfunction mapDiscordRoleToAppRole(discordRoles) {\n    console.log(\"Mapping Discord roles:\", discordRoles);\n    // Log all the roles we're checking for\n    console.log(\"Role mapping configuration:\");\n    for (const [roleName, roleId] of Object.entries(DISCORD_ROLES)){\n        console.log(`- ${formatRoleDisplay(roleName)}: ${roleId}`);\n    }\n    // Check each role in order of priority (following our hierarchy)\n    // Only check roles that can be automatically assigned through Discord\n    for (const appRole of ROLE_HIERARCHY){\n        // Skip roles that cannot be assigned through Discord\n        if (!DISCORD_ASSIGNABLE_ROLES.includes(appRole)) continue;\n        // Get the corresponding Discord role ID\n        const discordRoleId = DISCORD_ROLES[appRole];\n        // If we have a Discord role ID for this app role\n        if (discordRoleId && discordRoles.includes(discordRoleId)) {\n            console.log(` Found ${appRole} role!`);\n            return appRole;\n        }\n    }\n    console.log(\" No matching roles found, defaulting to APPLICANT\");\n    // Default role if no matching roles found\n    return \"APPLICANT\";\n}\n// Function to fetch user's Discord roles with rate limit handling\nasync function fetchDiscordRoles(discordId) {\n    if (!discordId) {\n        console.log(\"No Discord ID provided\");\n        return [];\n    }\n    console.log(`Fetching Discord roles for user ${discordId}`);\n    // Check if we have the required environment variables\n    if (!process.env.DISCORD_BOT_TOKEN) {\n        console.error(\"Missing required environment variable: DISCORD_BOT_TOKEN\");\n        return [];\n    }\n    if (!process.env.DISCORD_GUILD_ID) {\n        console.error(\"Missing required environment variable: DISCORD_GUILD_ID\");\n        return [];\n    }\n    console.log(`Using Guild ID: ${process.env.DISCORD_GUILD_ID}`);\n    console.log(`Bot token available: ${process.env.DISCORD_BOT_TOKEN ? \"Yes\" : \"No\"}`);\n    try {\n        const url = `https://discord.com/api/v10/guilds/${process.env.DISCORD_GUILD_ID}/members/${discordId}`;\n        console.log(`Making request to: ${url}`);\n        const response = await fetch(url, {\n            headers: {\n                Authorization: `Bot ${process.env.DISCORD_BOT_TOKEN}`\n            },\n            cache: \"no-store\"\n        });\n        console.log(`Discord API response status: ${response.status}`);\n        // Check for rate limiting\n        if (response.status === 429) {\n            const rateLimitData = await response.json();\n            const retryAfter = rateLimitData.retry_after || 5;\n            console.warn(`Discord API rate limited. Retry after ${retryAfter} seconds.`);\n            // Wait for the retry-after period plus a small buffer\n            await new Promise((resolve)=>setTimeout(resolve, retryAfter * 1000 + 500));\n            // Try again recursively after waiting\n            return fetchDiscordRoles(discordId);\n        }\n        if (response.status === 404) {\n            console.error(`User ${discordId} not found in Discord server`);\n            const errorText = await response.text();\n            console.error(`Error response: ${errorText}`);\n            return [];\n        }\n        if (!response.ok) {\n            console.error(`Discord API error: ${response.status} ${response.statusText}`);\n            const errorText = await response.text();\n            console.error(`Error response: ${errorText}`);\n            return [];\n        }\n        // Log rate limit headers for monitoring\n        const remaining = response.headers.get(\"X-RateLimit-Remaining\");\n        const reset = response.headers.get(\"X-RateLimit-Reset\");\n        if (remaining) {\n            console.log(`Discord API rate limit: ${remaining} requests remaining`);\n        }\n        if (reset) {\n            console.log(`Discord API rate limit resets at: ${new Date(Number.parseInt(reset) * 1000).toLocaleTimeString()}`);\n        }\n        const data = await response.json();\n        console.log(\"Discord API response received\");\n        if (data.roles && Array.isArray(data.roles)) {\n            console.log(`Found ${data.roles.length} roles for user:`, data.roles);\n            return data.roles;\n        } else {\n            console.log(\"No roles found in response or invalid format:\", JSON.stringify(data));\n            return [];\n        }\n    } catch (error) {\n        console.error(\"Error fetching Discord roles:\", error);\n        return [];\n    }\n}\n// Function to sync user's role based on Discord roles\nasync function syncUserRoleFromDiscord(discordId) {\n    try {\n        console.log(`Syncing role for Discord ID: ${discordId}`);\n        const discordRoles = await fetchDiscordRoles(discordId);\n        if (!discordRoles.length) {\n            console.log(\"No Discord roles found, returning null\");\n            return null;\n        }\n        const mappedRole = mapDiscordRoleToAppRole(discordRoles);\n        console.log(`Mapped Discord roles to application role: ${mappedRole}`);\n        return mappedRole;\n    } catch (error) {\n        console.error(\"Error syncing user role from Discord:\", error);\n        return null;\n    }\n}\n// Function to check if a role should be preserved during sync\nfunction shouldPreserveRole(role) {\n    // Admin roles should never be downgraded by automatic sync\n    return ADMIN_ROLES.includes(role);\n}\n// Add this function to check if user has RNR permissions\nfunction hasRnRPermission(role) {\n    return [\n        \"WEBMASTER\",\n        \"HEAD_ADMIN\",\n        \"SENIOR_ADMIN\",\n        \"SPECIAL_ADVISOR\"\n    ].includes(role) || role === \"RNR_ADMINISTRATION\" || role === \"RNR_STAFF\" || role === \"RNR_MEMBER\";\n}\n// Add this function to check if user can override RNR decisions\nfunction canOverrideRnRDecisions(role) {\n    return [\n        \"WEBMASTER\",\n        \"HEAD_ADMIN\",\n        \"SENIOR_ADMIN\",\n        \"SPECIAL_ADVISOR\"\n    ].includes(role) || role === \"RNR_ADMINISTRATION\" || role === \"RNR_STAFF\";\n}\n// Add this function to check if user can approve underage applicants\nfunction canApproveUnderage(role) {\n    return [\n        \"WEBMASTER\",\n        \"HEAD_ADMIN\",\n        \"SENIOR_ADMIN\",\n        \"SPECIAL_ADVISOR\"\n    ].includes(role) || role === \"RNR_ADMINISTRATION\";\n}\n// Add this function to check if a user can access specific application types\nfunction canAccessApplicationType(role, departmentId) {\n    // Applicants can only access CIV and BSFR applications\n    if (role === \"APPLICANT\") {\n        return [\n            \"CIV\",\n            \"BSFR\"\n        ].includes(departmentId);\n    }\n    // All other roles can access any application type\n    return true;\n}\n// Add this function to get available departments based on user role\nfunction getAvailableDepartmentsForRole(role) {\n    // Applicants can only see CIV and BSFR\n    if (role === \"APPLICANT\") {\n        return [\n            \"CIV\",\n            \"BSFR\"\n        ];\n    }\n    // Return all departments for other roles\n    // This list can be expanded as new departments are added\n    return [\n        \"CIV\",\n        \"BSFR\",\n        \"BSO\",\n        \"MPD\",\n        \"FHP\",\n        \"FWC\"\n    ];\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UztBQUNuRztBQUVBLDZFQUE2RTtBQUN0RSxTQUFTb0YseUJBQXlCcEYsSUFBWSxFQUFFcUYsWUFBb0I7SUFDekUsdURBQXVEO0lBQ3ZELElBQUlyRixTQUFTLGFBQWE7UUFDeEIsT0FBTztZQUFDO1lBQU87U0FBTyxDQUFDQyxRQUFRLENBQUNvRjtJQUNsQztJQUVBLGtEQUFrRDtJQUNsRCxPQUFPO0FBQ1Q7QUFFQSxvRUFBb0U7QUFDN0QsU0FBU0MsK0JBQStCdEYsSUFBWTtJQUN6RCx1Q0FBdUM7SUFDdkMsSUFBSUEsU0FBUyxhQUFhO1FBQ3hCLE9BQU87WUFBQztZQUFPO1NBQU87SUFDeEI7SUFFQSx5Q0FBeUM7SUFDekMseURBQXlEO0lBQ3pELE9BQU87UUFBQztRQUFPO1FBQVE7UUFBTztRQUFPO1FBQU87S0FBTTtBQUNwRCIsInNvdXJjZXMiOlsiQzpcXHhhbXBwXFxub2RlanMtYXBwc1xcY29tbXVuaXR5LWZvcnVtXFxsaWJcXHJvbGVzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgUm9sZSB9IGZyb20gXCJAcHJpc21hL2NsaWVudFwiXHJcblxyXG4vLyBSb2xlIGhpZXJhcmNoeSBmcm9tIGhpZ2hlc3QgdG8gbG93ZXN0XHJcbmV4cG9ydCBjb25zdCBST0xFX0hJRVJBUkNIWSA9IFtcclxuICBcIldFQk1BU1RFUlwiLFxyXG4gIFwiSEVBRF9BRE1JTlwiLFxyXG4gIFwiU0VOSU9SX0FETUlOXCIsXHJcbiAgXCJTUEVDSUFMX0FEVklTT1JcIixcclxuICBcIkFETUlOXCIsXHJcbiAgXCJKVU5JT1JfQURNSU5cIixcclxuICBcIlNFTklPUl9TVEFGRlwiLFxyXG4gIFwiU1RBRkZcIixcclxuICBcIlNUQUZGX0lOX1RSQUlOSU5HXCIsXHJcbiAgXCJNRU1CRVJcIixcclxuICBcIkFQUExJQ0FOVFwiLFxyXG5dIGFzIGNvbnN0XHJcblxyXG4vLyBHcm91cCByb2xlcyBieSBwZXJtaXNzaW9uIGxldmVsXHJcbmV4cG9ydCBjb25zdCBBRE1JTl9ST0xFUyA9IFtcIldFQk1BU1RFUlwiLCBcIkhFQURfQURNSU5cIiwgXCJTRU5JT1JfQURNSU5cIiwgXCJTUEVDSUFMX0FEVklTT1JcIiwgXCJBRE1JTlwiXVxyXG5leHBvcnQgY29uc3QgU1RBRkZfUk9MRVMgPSBbXCJKVU5JT1JfQURNSU5cIiwgXCJTRU5JT1JfU1RBRkZcIiwgXCJTVEFGRlwiXVxyXG5leHBvcnQgY29uc3QgQkFTSUNfUk9MRVMgPSBbXCJTVEFGRl9JTl9UUkFJTklOR1wiLCBcIk1FTUJFUlwiLCBcIkFQUExJQ0FOVFwiXVxyXG5cclxuLy8gUm9sZXMgdGhhdCBjYW4gYmUgYXV0b21hdGljYWxseSBhc3NpZ25lZCB0aHJvdWdoIERpc2NvcmRcclxuZXhwb3J0IGNvbnN0IERJU0NPUkRfQVNTSUdOQUJMRV9ST0xFUyA9IFtcclxuICBcIkpVTklPUl9BRE1JTlwiLFxyXG4gIFwiU0VOSU9SX1NUQUZGXCIsXHJcbiAgXCJTVEFGRlwiLFxyXG4gIFwiU1RBRkZfSU5fVFJBSU5JTkdcIixcclxuICBcIk1FTUJFUlwiLFxyXG4gIFwiQVBQTElDQU5UXCIsXHJcbl1cclxuXHJcbi8vIENoZWNrIGlmIGEgdXNlciBoYXMgYWRtaW4gcGVybWlzc2lvbnNcclxuZXhwb3J0IGZ1bmN0aW9uIGhhc0FkbWluUGVybWlzc2lvbihyb2xlPzogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgcmV0dXJuIHJvbGUgPyBBRE1JTl9ST0xFUy5pbmNsdWRlcyhyb2xlKSA6IGZhbHNlXHJcbn1cclxuXHJcbi8vIENoZWNrIGlmIGEgdXNlciBoYXMgc3RhZmYgcGVybWlzc2lvbnNcclxuZXhwb3J0IGZ1bmN0aW9uIGhhc1N0YWZmUGVybWlzc2lvbihyb2xlPzogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgcmV0dXJuIHJvbGUgPyBBRE1JTl9ST0xFUy5pbmNsdWRlcyhyb2xlKSB8fCBTVEFGRl9ST0xFUy5pbmNsdWRlcyhyb2xlKSA6IGZhbHNlXHJcbn1cclxuXHJcbi8vIENoZWNrIGlmIGEgdXNlciBpcyBhIHdlYm1hc3RlciAoc3BlY2lhbCBwZXJtaXNzaW9ucylcclxuZXhwb3J0IGZ1bmN0aW9uIGlzV2VibWFzdGVyKHJvbGU/OiBzdHJpbmcpOiBib29sZWFuIHtcclxuICByZXR1cm4gcm9sZSA9PT0gXCJXRUJNQVNURVJcIlxyXG59XHJcblxyXG4vLyBDaGVjayBpZiBhIHVzZXIgY2FuIGFzc2lnbiBhIHNwZWNpZmljIHJvbGVcclxuZXhwb3J0IGZ1bmN0aW9uIGNhbkFzc2lnblJvbGUodXNlclJvbGU/OiBzdHJpbmcsIHRhcmdldFJvbGU/OiBzdHJpbmcpOiBib29sZWFuIHtcclxuICBpZiAoIXVzZXJSb2xlIHx8ICF0YXJnZXRSb2xlKSByZXR1cm4gZmFsc2VcclxuXHJcbiAgLy8gV2VibWFzdGVyIGNhbiBhc3NpZ24gYW55IHJvbGVcclxuICBpZiAodXNlclJvbGUgPT09IFwiV0VCTUFTVEVSXCIpIHJldHVybiB0cnVlXHJcblxyXG4gIC8vIEdldCB0aGUgaW5kaWNlcyBpbiB0aGUgaGllcmFyY2h5IChsb3dlciBpbmRleCA9IGhpZ2hlciByYW5rKVxyXG4gIGNvbnN0IHVzZXJSb2xlSW5kZXggPSBST0xFX0hJRVJBUkNIWS5pbmRleE9mKHVzZXJSb2xlIGFzIGFueSlcclxuICBjb25zdCB0YXJnZXRSb2xlSW5kZXggPSBST0xFX0hJRVJBUkNIWS5pbmRleE9mKHRhcmdldFJvbGUgYXMgYW55KVxyXG5cclxuICAvLyBVc2VyIGNhbiBvbmx5IGFzc2lnbiByb2xlcyB0aGF0IGFyZSBsb3dlciBpbiB0aGUgaGllcmFyY2h5IChoaWdoZXIgaW5kZXgpXHJcbiAgcmV0dXJuIHVzZXJSb2xlSW5kZXggPCB0YXJnZXRSb2xlSW5kZXhcclxufVxyXG5cclxuLy8gR2V0IGF2YWlsYWJsZSByb2xlcyB0aGF0IGEgdXNlciBjYW4gYXNzaWduXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRBc3NpZ25hYmxlUm9sZXModXNlclJvbGU/OiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgaWYgKCF1c2VyUm9sZSkgcmV0dXJuIFtdXHJcblxyXG4gIC8vIFdlYm1hc3RlciBjYW4gYXNzaWduIGFueSByb2xlIGV4Y2VwdCB3ZWJtYXN0ZXIgaXRzZWxmXHJcbiAgaWYgKHVzZXJSb2xlID09PSBcIldFQk1BU1RFUlwiKSB7XHJcbiAgICByZXR1cm4gUk9MRV9ISUVSQVJDSFkuZmlsdGVyKChyb2xlKSA9PiByb2xlICE9PSBcIldFQk1BU1RFUlwiKVxyXG4gIH1cclxuXHJcbiAgLy8gSEVBRF9BRE1JTiBjYW4gYXNzaWduIGFueSByb2xlIGV4Y2VwdCBXRUJNQVNURVJcclxuICBpZiAodXNlclJvbGUgPT09IFwiSEVBRF9BRE1JTlwiKSB7XHJcbiAgICByZXR1cm4gUk9MRV9ISUVSQVJDSFkuZmlsdGVyKChyb2xlKSA9PiByb2xlICE9PSBcIldFQk1BU1RFUlwiKVxyXG4gIH1cclxuXHJcbiAgLy8gU0VOSU9SX0FETUlOIGNhbiBhc3NpZ24gcm9sZXMgdXAgdG8gQURNSU5cclxuICBpZiAodXNlclJvbGUgPT09IFwiU0VOSU9SX0FETUlOXCIpIHtcclxuICAgIHJldHVybiBST0xFX0hJRVJBUkNIWS5maWx0ZXIoKHJvbGUpID0+ICFbXCJXRUJNQVNURVJcIiwgXCJIRUFEX0FETUlOXCIsIFwiU0VOSU9SX0FETUlOXCJdLmluY2x1ZGVzKHJvbGUpKVxyXG4gIH1cclxuXHJcbiAgLy8gU1BFQ0lBTF9BRFZJU09SIGFuZCBBRE1JTiBjYW4gYXNzaWduIHJvbGVzIHVwIHRvIEpVTklPUl9BRE1JTlxyXG4gIGlmICh1c2VyUm9sZSA9PT0gXCJTUEVDSUFMX0FEVklTT1JcIiB8fCB1c2VyUm9sZSA9PT0gXCJBRE1JTlwiKSB7XHJcbiAgICByZXR1cm4gUk9MRV9ISUVSQVJDSFkuZmlsdGVyKFxyXG4gICAgICAocm9sZSkgPT4gIVtcIldFQk1BU1RFUlwiLCBcIkhFQURfQURNSU5cIiwgXCJTRU5JT1JfQURNSU5cIiwgXCJTUEVDSUFMX0FEVklTT1JcIiwgXCJBRE1JTlwiXS5pbmNsdWRlcyhyb2xlKSxcclxuICAgIClcclxuICB9XHJcblxyXG4gIC8vIEpVTklPUl9BRE1JTiBjYW4gYXNzaWduIGJhc2ljIHJvbGVzXHJcbiAgaWYgKHVzZXJSb2xlID09PSBcIkpVTklPUl9BRE1JTlwiKSB7XHJcbiAgICByZXR1cm4gQkFTSUNfUk9MRVNcclxuICB9XHJcblxyXG4gIC8vIE90aGVyIHJvbGVzIGNhbid0IGFzc2lnbiByb2xlc1xyXG4gIHJldHVybiBbXVxyXG59XHJcblxyXG4vLyBGb3JtYXQgcm9sZSBmb3IgZGlzcGxheVxyXG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0Um9sZURpc3BsYXkocm9sZTogc3RyaW5nKTogc3RyaW5nIHtcclxuICByZXR1cm4gcm9sZVxyXG4gICAgLnNwbGl0KFwiX1wiKVxyXG4gICAgLm1hcCgod29yZCkgPT4gd29yZC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHdvcmQuc2xpY2UoMSkudG9Mb3dlckNhc2UoKSlcclxuICAgIC5qb2luKFwiIFwiKVxyXG59XHJcblxyXG4vLyBEaXNjb3JkIHJvbGUgSURzIC0gb25seSBmb3Igcm9sZXMgdGhhdCBjYW4gYmUgYXV0b21hdGljYWxseSBhc3NpZ25lZFxyXG5leHBvcnQgY29uc3QgRElTQ09SRF9ST0xFUyA9IHtcclxuICAvLyBTdGFmZiBsZXZlbCByb2xlc1xyXG4gIEpVTklPUl9BRE1JTjogXCIxMjA5NTY3NzY5ODI2Mjk1ODk5XCIsIC8vIFVzaW5nIHRoZSBTZW5pb3IgU3RhZmYgSUQgZm9yIG5vd1xyXG4gIFNFTklPUl9TVEFGRjogXCIxMjA5NTY3NzY5ODI2Mjk1ODk5XCIsXHJcbiAgU1RBRkY6IFwiMTIwOTg1Mjg0MjcyNzMxMzQzOFwiLFxyXG5cclxuICAvLyBCYXNpYyBsZXZlbCByb2xlc1xyXG4gIFNUQUZGX0lOX1RSQUlOSU5HOiBcIjEyMDk4NTI4NDM1NzQ2OTM5MThcIixcclxuICBNRU1CRVI6IFwiMTI1Mzc2MTAxODc2OTk2OTI0NFwiLFxyXG4gIEFQUExJQ0FOVDogXCIxMjUzNzU4MDMxMTEyNTY4ODMyXCIsXHJcbn1cclxuXHJcbi8vIE1hcCBEaXNjb3JkIHJvbGVzIHRvIGFwcGxpY2F0aW9uIHJvbGVzXHJcbmV4cG9ydCBmdW5jdGlvbiBtYXBEaXNjb3JkUm9sZVRvQXBwUm9sZShkaXNjb3JkUm9sZXM6IHN0cmluZ1tdKTogUm9sZSB7XHJcbiAgY29uc29sZS5sb2coXCJNYXBwaW5nIERpc2NvcmQgcm9sZXM6XCIsIGRpc2NvcmRSb2xlcylcclxuXHJcbiAgLy8gTG9nIGFsbCB0aGUgcm9sZXMgd2UncmUgY2hlY2tpbmcgZm9yXHJcbiAgY29uc29sZS5sb2coXCJSb2xlIG1hcHBpbmcgY29uZmlndXJhdGlvbjpcIilcclxuICBmb3IgKGNvbnN0IFtyb2xlTmFtZSwgcm9sZUlkXSBvZiBPYmplY3QuZW50cmllcyhESVNDT1JEX1JPTEVTKSkge1xyXG4gICAgY29uc29sZS5sb2coYC0gJHtmb3JtYXRSb2xlRGlzcGxheShyb2xlTmFtZSl9OiAke3JvbGVJZH1gKVxyXG4gIH1cclxuXHJcbiAgLy8gQ2hlY2sgZWFjaCByb2xlIGluIG9yZGVyIG9mIHByaW9yaXR5IChmb2xsb3dpbmcgb3VyIGhpZXJhcmNoeSlcclxuICAvLyBPbmx5IGNoZWNrIHJvbGVzIHRoYXQgY2FuIGJlIGF1dG9tYXRpY2FsbHkgYXNzaWduZWQgdGhyb3VnaCBEaXNjb3JkXHJcbiAgZm9yIChjb25zdCBhcHBSb2xlIG9mIFJPTEVfSElFUkFSQ0hZKSB7XHJcbiAgICAvLyBTa2lwIHJvbGVzIHRoYXQgY2Fubm90IGJlIGFzc2lnbmVkIHRocm91Z2ggRGlzY29yZFxyXG4gICAgaWYgKCFESVNDT1JEX0FTU0lHTkFCTEVfUk9MRVMuaW5jbHVkZXMoYXBwUm9sZSkpIGNvbnRpbnVlXHJcblxyXG4gICAgLy8gR2V0IHRoZSBjb3JyZXNwb25kaW5nIERpc2NvcmQgcm9sZSBJRFxyXG4gICAgY29uc3QgZGlzY29yZFJvbGVJZCA9IERJU0NPUkRfUk9MRVNbYXBwUm9sZSBhcyBrZXlvZiB0eXBlb2YgRElTQ09SRF9ST0xFU11cclxuXHJcbiAgICAvLyBJZiB3ZSBoYXZlIGEgRGlzY29yZCByb2xlIElEIGZvciB0aGlzIGFwcCByb2xlXHJcbiAgICBpZiAoZGlzY29yZFJvbGVJZCAmJiBkaXNjb3JkUm9sZXMuaW5jbHVkZXMoZGlzY29yZFJvbGVJZCkpIHtcclxuICAgICAgY29uc29sZS5sb2coYOKchSBGb3VuZCAke2FwcFJvbGV9IHJvbGUhYClcclxuICAgICAgcmV0dXJuIGFwcFJvbGUgYXMgUm9sZVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgY29uc29sZS5sb2coXCLinYwgTm8gbWF0Y2hpbmcgcm9sZXMgZm91bmQsIGRlZmF1bHRpbmcgdG8gQVBQTElDQU5UXCIpXHJcbiAgLy8gRGVmYXVsdCByb2xlIGlmIG5vIG1hdGNoaW5nIHJvbGVzIGZvdW5kXHJcbiAgcmV0dXJuIFwiQVBQTElDQU5UXCJcclxufVxyXG5cclxuLy8gRnVuY3Rpb24gdG8gZmV0Y2ggdXNlcidzIERpc2NvcmQgcm9sZXMgd2l0aCByYXRlIGxpbWl0IGhhbmRsaW5nXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmZXRjaERpc2NvcmRSb2xlcyhkaXNjb3JkSWQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nW10+IHtcclxuICBpZiAoIWRpc2NvcmRJZCkge1xyXG4gICAgY29uc29sZS5sb2coXCJObyBEaXNjb3JkIElEIHByb3ZpZGVkXCIpXHJcbiAgICByZXR1cm4gW11cclxuICB9XHJcblxyXG4gIGNvbnNvbGUubG9nKGBGZXRjaGluZyBEaXNjb3JkIHJvbGVzIGZvciB1c2VyICR7ZGlzY29yZElkfWApXHJcblxyXG4gIC8vIENoZWNrIGlmIHdlIGhhdmUgdGhlIHJlcXVpcmVkIGVudmlyb25tZW50IHZhcmlhYmxlc1xyXG4gIGlmICghcHJvY2Vzcy5lbnYuRElTQ09SRF9CT1RfVE9LRU4pIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJNaXNzaW5nIHJlcXVpcmVkIGVudmlyb25tZW50IHZhcmlhYmxlOiBESVNDT1JEX0JPVF9UT0tFTlwiKVxyXG4gICAgcmV0dXJuIFtdXHJcbiAgfVxyXG5cclxuICBpZiAoIXByb2Nlc3MuZW52LkRJU0NPUkRfR1VJTERfSUQpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJNaXNzaW5nIHJlcXVpcmVkIGVudmlyb25tZW50IHZhcmlhYmxlOiBESVNDT1JEX0dVSUxEX0lEXCIpXHJcbiAgICByZXR1cm4gW11cclxuICB9XHJcblxyXG4gIGNvbnNvbGUubG9nKGBVc2luZyBHdWlsZCBJRDogJHtwcm9jZXNzLmVudi5ESVNDT1JEX0dVSUxEX0lEfWApXHJcbiAgY29uc29sZS5sb2coYEJvdCB0b2tlbiBhdmFpbGFibGU6ICR7cHJvY2Vzcy5lbnYuRElTQ09SRF9CT1RfVE9LRU4gPyBcIlllc1wiIDogXCJOb1wifWApXHJcblxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB1cmwgPSBgaHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvdjEwL2d1aWxkcy8ke3Byb2Nlc3MuZW52LkRJU0NPUkRfR1VJTERfSUR9L21lbWJlcnMvJHtkaXNjb3JkSWR9YFxyXG4gICAgY29uc29sZS5sb2coYE1ha2luZyByZXF1ZXN0IHRvOiAke3VybH1gKVxyXG5cclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBBdXRob3JpemF0aW9uOiBgQm90ICR7cHJvY2Vzcy5lbnYuRElTQ09SRF9CT1RfVE9LRU59YCxcclxuICAgICAgfSxcclxuICAgICAgY2FjaGU6IFwibm8tc3RvcmVcIiwgLy8gRW5zdXJlIHdlIGRvbid0IHVzZSBjYWNoZWQgcmVzcG9uc2VzXHJcbiAgICB9KVxyXG5cclxuICAgIGNvbnNvbGUubG9nKGBEaXNjb3JkIEFQSSByZXNwb25zZSBzdGF0dXM6ICR7cmVzcG9uc2Uuc3RhdHVzfWApXHJcblxyXG4gICAgLy8gQ2hlY2sgZm9yIHJhdGUgbGltaXRpbmdcclxuICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQyOSkge1xyXG4gICAgICBjb25zdCByYXRlTGltaXREYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpXHJcbiAgICAgIGNvbnN0IHJldHJ5QWZ0ZXIgPSByYXRlTGltaXREYXRhLnJldHJ5X2FmdGVyIHx8IDVcclxuICAgICAgY29uc29sZS53YXJuKGBEaXNjb3JkIEFQSSByYXRlIGxpbWl0ZWQuIFJldHJ5IGFmdGVyICR7cmV0cnlBZnRlcn0gc2Vjb25kcy5gKVxyXG5cclxuICAgICAgLy8gV2FpdCBmb3IgdGhlIHJldHJ5LWFmdGVyIHBlcmlvZCBwbHVzIGEgc21hbGwgYnVmZmVyXHJcbiAgICAgIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIHJldHJ5QWZ0ZXIgKiAxMDAwICsgNTAwKSlcclxuXHJcbiAgICAgIC8vIFRyeSBhZ2FpbiByZWN1cnNpdmVseSBhZnRlciB3YWl0aW5nXHJcbiAgICAgIHJldHVybiBmZXRjaERpc2NvcmRSb2xlcyhkaXNjb3JkSWQpXHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDA0KSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoYFVzZXIgJHtkaXNjb3JkSWR9IG5vdCBmb3VuZCBpbiBEaXNjb3JkIHNlcnZlcmApXHJcbiAgICAgIGNvbnN0IGVycm9yVGV4dCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKVxyXG4gICAgICBjb25zb2xlLmVycm9yKGBFcnJvciByZXNwb25zZTogJHtlcnJvclRleHR9YClcclxuICAgICAgcmV0dXJuIFtdXHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGBEaXNjb3JkIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXN9ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKVxyXG4gICAgICBjb25zdCBlcnJvclRleHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KClcclxuICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgcmVzcG9uc2U6ICR7ZXJyb3JUZXh0fWApXHJcbiAgICAgIHJldHVybiBbXVxyXG4gICAgfVxyXG5cclxuICAgIC8vIExvZyByYXRlIGxpbWl0IGhlYWRlcnMgZm9yIG1vbml0b3JpbmdcclxuICAgIGNvbnN0IHJlbWFpbmluZyA9IHJlc3BvbnNlLmhlYWRlcnMuZ2V0KFwiWC1SYXRlTGltaXQtUmVtYWluaW5nXCIpXHJcbiAgICBjb25zdCByZXNldCA9IHJlc3BvbnNlLmhlYWRlcnMuZ2V0KFwiWC1SYXRlTGltaXQtUmVzZXRcIilcclxuICAgIGlmIChyZW1haW5pbmcpIHtcclxuICAgICAgY29uc29sZS5sb2coYERpc2NvcmQgQVBJIHJhdGUgbGltaXQ6ICR7cmVtYWluaW5nfSByZXF1ZXN0cyByZW1haW5pbmdgKVxyXG4gICAgfVxyXG4gICAgaWYgKHJlc2V0KSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBEaXNjb3JkIEFQSSByYXRlIGxpbWl0IHJlc2V0cyBhdDogJHtuZXcgRGF0ZShOdW1iZXIucGFyc2VJbnQocmVzZXQpICogMTAwMCkudG9Mb2NhbGVUaW1lU3RyaW5nKCl9YClcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpXHJcbiAgICBjb25zb2xlLmxvZyhcIkRpc2NvcmQgQVBJIHJlc3BvbnNlIHJlY2VpdmVkXCIpXHJcblxyXG4gICAgaWYgKGRhdGEucm9sZXMgJiYgQXJyYXkuaXNBcnJheShkYXRhLnJvbGVzKSkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgRm91bmQgJHtkYXRhLnJvbGVzLmxlbmd0aH0gcm9sZXMgZm9yIHVzZXI6YCwgZGF0YS5yb2xlcylcclxuICAgICAgcmV0dXJuIGRhdGEucm9sZXNcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwiTm8gcm9sZXMgZm91bmQgaW4gcmVzcG9uc2Ugb3IgaW52YWxpZCBmb3JtYXQ6XCIsIEpTT04uc3RyaW5naWZ5KGRhdGEpKVxyXG4gICAgICByZXR1cm4gW11cclxuICAgIH1cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGZldGNoaW5nIERpc2NvcmQgcm9sZXM6XCIsIGVycm9yKVxyXG4gICAgcmV0dXJuIFtdXHJcbiAgfVxyXG59XHJcblxyXG4vLyBGdW5jdGlvbiB0byBzeW5jIHVzZXIncyByb2xlIGJhc2VkIG9uIERpc2NvcmQgcm9sZXNcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHN5bmNVc2VyUm9sZUZyb21EaXNjb3JkKGRpc2NvcmRJZDogc3RyaW5nKTogUHJvbWlzZTxSb2xlIHwgbnVsbD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgU3luY2luZyByb2xlIGZvciBEaXNjb3JkIElEOiAke2Rpc2NvcmRJZH1gKVxyXG4gICAgY29uc3QgZGlzY29yZFJvbGVzID0gYXdhaXQgZmV0Y2hEaXNjb3JkUm9sZXMoZGlzY29yZElkKVxyXG5cclxuICAgIGlmICghZGlzY29yZFJvbGVzLmxlbmd0aCkge1xyXG4gICAgICBjb25zb2xlLmxvZyhcIk5vIERpc2NvcmQgcm9sZXMgZm91bmQsIHJldHVybmluZyBudWxsXCIpXHJcbiAgICAgIHJldHVybiBudWxsXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgbWFwcGVkUm9sZSA9IG1hcERpc2NvcmRSb2xlVG9BcHBSb2xlKGRpc2NvcmRSb2xlcylcclxuICAgIGNvbnNvbGUubG9nKGBNYXBwZWQgRGlzY29yZCByb2xlcyB0byBhcHBsaWNhdGlvbiByb2xlOiAke21hcHBlZFJvbGV9YClcclxuICAgIHJldHVybiBtYXBwZWRSb2xlXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBzeW5jaW5nIHVzZXIgcm9sZSBmcm9tIERpc2NvcmQ6XCIsIGVycm9yKVxyXG4gICAgcmV0dXJuIG51bGxcclxuICB9XHJcbn1cclxuXHJcbi8vIEZ1bmN0aW9uIHRvIGNoZWNrIGlmIGEgcm9sZSBzaG91bGQgYmUgcHJlc2VydmVkIGR1cmluZyBzeW5jXHJcbmV4cG9ydCBmdW5jdGlvbiBzaG91bGRQcmVzZXJ2ZVJvbGUocm9sZTogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgLy8gQWRtaW4gcm9sZXMgc2hvdWxkIG5ldmVyIGJlIGRvd25ncmFkZWQgYnkgYXV0b21hdGljIHN5bmNcclxuICByZXR1cm4gQURNSU5fUk9MRVMuaW5jbHVkZXMocm9sZSlcclxufVxyXG5cclxuLy8gQWRkIHRoaXMgZnVuY3Rpb24gdG8gY2hlY2sgaWYgdXNlciBoYXMgUk5SIHBlcm1pc3Npb25zXHJcbmV4cG9ydCBmdW5jdGlvbiBoYXNSblJQZXJtaXNzaW9uKHJvbGU6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gIHJldHVybiAoXHJcbiAgICBbXCJXRUJNQVNURVJcIiwgXCJIRUFEX0FETUlOXCIsIFwiU0VOSU9SX0FETUlOXCIsIFwiU1BFQ0lBTF9BRFZJU09SXCJdLmluY2x1ZGVzKHJvbGUpIHx8XHJcbiAgICByb2xlID09PSBcIlJOUl9BRE1JTklTVFJBVElPTlwiIHx8XHJcbiAgICByb2xlID09PSBcIlJOUl9TVEFGRlwiIHx8XHJcbiAgICByb2xlID09PSBcIlJOUl9NRU1CRVJcIlxyXG4gIClcclxufVxyXG5cclxuLy8gQWRkIHRoaXMgZnVuY3Rpb24gdG8gY2hlY2sgaWYgdXNlciBjYW4gb3ZlcnJpZGUgUk5SIGRlY2lzaW9uc1xyXG5leHBvcnQgZnVuY3Rpb24gY2FuT3ZlcnJpZGVSblJEZWNpc2lvbnMocm9sZTogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgcmV0dXJuIChcclxuICAgIFtcIldFQk1BU1RFUlwiLCBcIkhFQURfQURNSU5cIiwgXCJTRU5JT1JfQURNSU5cIiwgXCJTUEVDSUFMX0FEVklTT1JcIl0uaW5jbHVkZXMocm9sZSkgfHxcclxuICAgIHJvbGUgPT09IFwiUk5SX0FETUlOSVNUUkFUSU9OXCIgfHxcclxuICAgIHJvbGUgPT09IFwiUk5SX1NUQUZGXCJcclxuICApXHJcbn1cclxuXHJcbi8vIEFkZCB0aGlzIGZ1bmN0aW9uIHRvIGNoZWNrIGlmIHVzZXIgY2FuIGFwcHJvdmUgdW5kZXJhZ2UgYXBwbGljYW50c1xyXG5leHBvcnQgZnVuY3Rpb24gY2FuQXBwcm92ZVVuZGVyYWdlKHJvbGU6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gIHJldHVybiBbXCJXRUJNQVNURVJcIiwgXCJIRUFEX0FETUlOXCIsIFwiU0VOSU9SX0FETUlOXCIsIFwiU1BFQ0lBTF9BRFZJU09SXCJdLmluY2x1ZGVzKHJvbGUpIHx8IHJvbGUgPT09IFwiUk5SX0FETUlOSVNUUkFUSU9OXCJcclxufVxyXG5cclxuLy8gQWRkIHRoaXMgZnVuY3Rpb24gdG8gY2hlY2sgaWYgYSB1c2VyIGNhbiBhY2Nlc3Mgc3BlY2lmaWMgYXBwbGljYXRpb24gdHlwZXNcclxuZXhwb3J0IGZ1bmN0aW9uIGNhbkFjY2Vzc0FwcGxpY2F0aW9uVHlwZShyb2xlOiBzdHJpbmcsIGRlcGFydG1lbnRJZDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgLy8gQXBwbGljYW50cyBjYW4gb25seSBhY2Nlc3MgQ0lWIGFuZCBCU0ZSIGFwcGxpY2F0aW9uc1xyXG4gIGlmIChyb2xlID09PSBcIkFQUExJQ0FOVFwiKSB7XHJcbiAgICByZXR1cm4gW1wiQ0lWXCIsIFwiQlNGUlwiXS5pbmNsdWRlcyhkZXBhcnRtZW50SWQpXHJcbiAgfVxyXG5cclxuICAvLyBBbGwgb3RoZXIgcm9sZXMgY2FuIGFjY2VzcyBhbnkgYXBwbGljYXRpb24gdHlwZVxyXG4gIHJldHVybiB0cnVlXHJcbn1cclxuXHJcbi8vIEFkZCB0aGlzIGZ1bmN0aW9uIHRvIGdldCBhdmFpbGFibGUgZGVwYXJ0bWVudHMgYmFzZWQgb24gdXNlciByb2xlXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRBdmFpbGFibGVEZXBhcnRtZW50c0ZvclJvbGUocm9sZTogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gIC8vIEFwcGxpY2FudHMgY2FuIG9ubHkgc2VlIENJViBhbmQgQlNGUlxyXG4gIGlmIChyb2xlID09PSBcIkFQUExJQ0FOVFwiKSB7XHJcbiAgICByZXR1cm4gW1wiQ0lWXCIsIFwiQlNGUlwiXVxyXG4gIH1cclxuXHJcbiAgLy8gUmV0dXJuIGFsbCBkZXBhcnRtZW50cyBmb3Igb3RoZXIgcm9sZXNcclxuICAvLyBUaGlzIGxpc3QgY2FuIGJlIGV4cGFuZGVkIGFzIG5ldyBkZXBhcnRtZW50cyBhcmUgYWRkZWRcclxuICByZXR1cm4gW1wiQ0lWXCIsIFwiQlNGUlwiLCBcIkJTT1wiLCBcIk1QRFwiLCBcIkZIUFwiLCBcIkZXQ1wiXVxyXG59XHJcbiJdLCJuYW1lcyI6WyJST0xFX0hJRVJBUkNIWSIsIkFETUlOX1JPTEVTIiwiU1RBRkZfUk9MRVMiLCJCQVNJQ19ST0xFUyIsIkRJU0NPUkRfQVNTSUdOQUJMRV9ST0xFUyIsImhhc0FkbWluUGVybWlzc2lvbiIsInJvbGUiLCJpbmNsdWRlcyIsImhhc1N0YWZmUGVybWlzc2lvbiIsImlzV2VibWFzdGVyIiwiY2FuQXNzaWduUm9sZSIsInVzZXJSb2xlIiwidGFyZ2V0Um9sZSIsInVzZXJSb2xlSW5kZXgiLCJpbmRleE9mIiwidGFyZ2V0Um9sZUluZGV4IiwiZ2V0QXNzaWduYWJsZVJvbGVzIiwiZmlsdGVyIiwiZm9ybWF0Um9sZURpc3BsYXkiLCJzcGxpdCIsIm1hcCIsIndvcmQiLCJjaGFyQXQiLCJ0b1VwcGVyQ2FzZSIsInNsaWNlIiwidG9Mb3dlckNhc2UiLCJqb2luIiwiRElTQ09SRF9ST0xFUyIsIkpVTklPUl9BRE1JTiIsIlNFTklPUl9TVEFGRiIsIlNUQUZGIiwiU1RBRkZfSU5fVFJBSU5JTkciLCJNRU1CRVIiLCJBUFBMSUNBTlQiLCJtYXBEaXNjb3JkUm9sZVRvQXBwUm9sZSIsImRpc2NvcmRSb2xlcyIsImNvbnNvbGUiLCJsb2ciLCJyb2xlTmFtZSIsInJvbGVJZCIsIk9iamVjdCIsImVudHJpZXMiLCJhcHBSb2xlIiwiZGlzY29yZFJvbGVJZCIsImZldGNoRGlzY29yZFJvbGVzIiwiZGlzY29yZElkIiwicHJvY2VzcyIsImVudiIsIkRJU0NPUkRfQk9UX1RPS0VOIiwiZXJyb3IiLCJESVNDT1JEX0dVSUxEX0lEIiwidXJsIiwicmVzcG9uc2UiLCJmZXRjaCIsImhlYWRlcnMiLCJBdXRob3JpemF0aW9uIiwiY2FjaGUiLCJzdGF0dXMiLCJyYXRlTGltaXREYXRhIiwianNvbiIsInJldHJ5QWZ0ZXIiLCJyZXRyeV9hZnRlciIsIndhcm4iLCJQcm9taXNlIiwicmVzb2x2ZSIsInNldFRpbWVvdXQiLCJlcnJvclRleHQiLCJ0ZXh0Iiwib2siLCJzdGF0dXNUZXh0IiwicmVtYWluaW5nIiwiZ2V0IiwicmVzZXQiLCJEYXRlIiwiTnVtYmVyIiwicGFyc2VJbnQiLCJ0b0xvY2FsZVRpbWVTdHJpbmciLCJkYXRhIiwicm9sZXMiLCJBcnJheSIsImlzQXJyYXkiLCJsZW5ndGgiLCJKU09OIiwic3RyaW5naWZ5Iiwic3luY1VzZXJSb2xlRnJvbURpc2NvcmQiLCJtYXBwZWRSb2xlIiwic2hvdWxkUHJlc2VydmVSb2xlIiwiaGFzUm5SUGVybWlzc2lvbiIsImNhbk92ZXJyaWRlUm5SRGVjaXNpb25zIiwiY2FuQXBwcm92ZVVuZGVyYWdlIiwiY2FuQWNjZXNzQXBwbGljYXRpb25UeXBlIiwiZGVwYXJ0bWVudElkIiwiZ2V0QXZhaWxhYmxlRGVwYXJ0bWVudHNGb3JSb2xlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/roles.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/next-auth","vendor-chunks/openid-client","vendor-chunks/bcryptjs","vendor-chunks/oauth","vendor-chunks/@babel","vendor-chunks/object-hash","vendor-chunks/preact","vendor-chunks/yallist","vendor-chunks/lru-cache","vendor-chunks/cookie","vendor-chunks/@auth","vendor-chunks/oidc-token-hash","vendor-chunks/@panva"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&page=%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute.ts&appDir=C%3A%5Cxampp%5Cnodejs-apps%5Ccommunity-forum%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5Cxampp%5Cnodejs-apps%5Ccommunity-forum&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();